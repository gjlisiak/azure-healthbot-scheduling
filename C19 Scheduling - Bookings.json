{
 "name": "C19 Scheduling -  Bookings",
 "id": "98b49213-bf36-4dd2-904a-d6dc589b543e",
 "scenario_trigger": "sched_bookings",
 "description": "",
 "active": true,
 "updated": "2021-02-10T13:21:13.6930000Z",
 "userDisplayName": "Gregory Lisiak",
 "code": "{\"version\":3,\"steps\":[{\"id\":\"e6ae055292b0-a644a58f6932b59d-1305\",\"type\":\"action\",\"label\":\"Action\",\"designer\":{\"xLocation\":240,\"yLocation\":60,\"next\":\"83549b07214d-14b4875cd54d4305-e135\"},\"onInit\":\"scenario.scope = getEnv(\\\"scope\\\");\\nscenario.clientid = getEnv(\\\"bookingsClientID\\\"); // From App Registration\\nscenario.clientsecret = getEnv(\\\"bookingsClientSecret\\\"); // From App Registration\\nscenario.username = getEnv(\\\"bookingsUsername\\\"); // Admin Account with Access to the Shift Schedule\\nscenario.password = getEnv(\\\"bookingsPassword\\\"); \\nscenario.granttype = 'password';\\nscenario.minDateForFirstAppointment = moment().add(1,'days').format(\\\"YYYY-MM-DD\\\");\\nscenario.bookingsServiceName = getEnv(\\\"bookingsServiceName\\\");\\nscenario.bookingsBusiness = getEnv(\\\"bookingsBusiness\\\");\\nscenario.TenantID = getEnv(\\\"tenantID\\\");\\n\\nscenario.manualExec = scenario.scenarioArgs.manualExec;\\nscenario.lat        = scenario.scenarioArgs.lat;\\nscenario.lng        = scenario.scenarioArgs.lng;\\nscenario.phase      = scenario.scenarioArgs.phase;\\nscenario.usePostal  = scenario.scenarioArgs.usePostal;\\nscenario.postalCode = scenario.scenarioArgs.postalCode;\\nscenario.FirstName  = scenario.scenarioArgs.FirstName;\\nscenario.LastName   = scenario.scenarioArgs.LastName;\\nscenario.DOB        = scenario.scenarioArgs.DOB;\\nscenario.Email      = scenario.scenarioArgs.Email;\\nscenario.Phone      = scenario.scenarioArgs.Phone;\\nscenario.Street1    = scenario.scenarioArgs.Street1;\\nscenario.Street2    = scenario.scenarioArgs.Street2;\\nscenario.City       = scenario.scenarioArgs.City;\\nscenario.State      = scenario.scenarioArgs.State;\\n\\nscenario.masterSlots = [\\n\\\"08:00 AM\\\",\\n\\\"08:20 AM\\\",\\n\\\"08:40 AM\\\",\\n\\\"09:00 AM\\\",\\n\\\"09:20 AM\\\",\\n\\\"09:40 AM\\\",\\n\\\"10:00 AM\\\",\\n\\\"10:20 AM\\\",\\n\\\"10:40 AM\\\",\\n\\\"11:00 AM\\\",\\n\\\"11:20 AM\\\",\\n\\\"11:40 AM\\\",\\n\\\"12:00 AM\\\",\\n\\\"12:20 PM\\\",\\n\\\"12:40 PM\\\",\\n\\\"01:00 PM\\\",\\n\\\"01:20 PM\\\",\\n\\\"01:40 PM\\\",\\n\\\"02:00 PM\\\",\\n\\\"02:20 PM\\\",\\n\\\"02:40 PM\\\",\\n\\\"03:00 PM\\\",\\n\\\"03:20 PM\\\",\\n\\\"03:40 PM\\\",\\n\\\"04:00 PM\\\",\\n\\\"04:20 PM\\\",\\n\\\"04:40 PM\\\",\\n\\\"05:00 PM\\\",\\n];\\nscenario.allSlots = scenario.masterSlots;\\n\"},{\"id\":\"83549b07214d-14b4875cd54d4305-e135\",\"type\":\"datasource\",\"designer\":{\"xLocation\":400,\"yLocation\":100,\"next\":\"49dd9e90a605-21e37e0da8ed5642-b98e\"},\"dataConnection\":\"\",\"urlBase\":\"'https://login.microsoftonline.com/' + scenario.TenantID + '/oauth2/v2.0/token'\",\"urlPath\":\"\",\"urlParams\":\"\",\"contentType\":\"x-www-form-urlencoded\",\"method\":\"post\",\"headers\":\"\",\"payload\":\"{\\r\\n\\\"grant_type\\\" : scenario.granttype,\\r\\n\\\"username\\\" : scenario.username,\\r\\n\\\"password\\\" : scenario.password,\\r\\n\\\"client_id\\\" : scenario.clientid,\\r\\n\\\"client_secret\\\" : scenario.clientsecret,\\r\\n\\\"scope\\\" : scenario.scope\\r\\n}\",\"opJson\":true,\"opResolveWithFullResponse\":false,\"response\":\"bearerToken\",\"error\":\"tokenError\",\"label\":\"GetToken\"},{\"id\":\"49dd9e90a605-21e37e0da8ed5642-b98e\",\"type\":\"datasource\",\"designer\":{\"xLocation\":400,\"yLocation\":166,\"next\":\"238111337e8e-b1c29490a8866d3b-8027\",\"errorStepId\":\"3ab45f7ea637-3686ab7450d24a52-8142\"},\"dataConnection\":\"\",\"urlBase\":\"'https://graph.microsoft.com/beta/bookingBusinesses/' + scenario.bookingsBusiness + '/services'\",\"urlPath\":\"\",\"urlParams\":\"\\\"$filter=displayName eq '\\\"+scenario.bookingsServiceName + \\\"'\\\"\",\"method\":\"get\",\"headers\":\"{\\r\\n    \\\"Authorization\\\" : \\\"Bearer \\\" + scenario.bearerToken.access_token\\r\\n}\",\"opJson\":true,\"opResolveWithFullResponse\":false,\"label\":\"GetBookingForBusiness\",\"response\":\"bookingBusiness\",\"error\":\"bookingBusinessError\"},{\"id\":\"80c3882920f8-d0b4aad5b0443e1f-1738\",\"type\":\"action\",\"label\":\"Action\",\"designer\":{\"xLocation\":500,\"yLocation\":512,\"next\":\"7a191c3102cd-f1b7a302986e8d4a-18c5\"},\"onInit\":\"var _ = require('underscore');\\r\\nvar timeslots = {};\\r\\n\\r\\n_.each(scenario.getScheduledSlots.value, function(value){\\r\\n     if (!timeslots[moment(value.start.dateTime).subtract(6, 'hours').format('hh:mm A')]) \\r\\n        timeslots[moment(value.start.dateTime).subtract(6, 'hours').format('hh:mm A')] = [];\\r\\n    timeslots[moment(value.start.dateTime).subtract(6, 'hours').format('hh:mm A')].push(value.staffMemberIds[0]);\\r\\n});\\r\\nfor (var key in timeslots) {\\r\\n    // check if the property/key is defined in the object itself, not in parent\\r\\n    if (timeslots.hasOwnProperty(key) && timeslots[key].length == scenario.bookingBusiness.value[0].staffMemberIds.length ) {           \\r\\n        scenario.allSlots = _.without(scenario.allSlots,key);\\r\\n    }\\r\\n}\\r\\nscenario.allSlots = scenario.allSlots.map(item => ({title:item , value:item }));\\r\\n\\r\\n\"},{\"id\":\"d60cc29ef803-5dbaba7b8a319ab8-57a7\",\"type\":\"branch\",\"condition\":\"scenario.getScheduledSlots.value.length > 0\",\"designer\":{\"xLocation\":400,\"yLocation\":447,\"next\":\"a040dfbd5f11-ef393ba0e5d8fde6-631a\"},\"targetStepId\":\"80c3882920f8-d0b4aad5b0443e1f-1738\"},{\"id\":\"a040dfbd5f11-ef393ba0e5d8fde6-631a\",\"type\":\"action\",\"label\":\"Action\",\"designer\":{\"xLocation\":280,\"yLocation\":520,\"next\":\"7a191c3102cd-f1b7a302986e8d4a-18c5\"},\"onInit\":\"scenario.allSlots = scenario.allSlots.map(item => ({title:item , value:item }));\"},{\"id\":\"238111337e8e-b1c29490a8866d3b-8027\",\"type\":\"prompt\",\"dataType\":\"object\",\"designer\":{\"xLocation\":400,\"yLocation\":234,\"next\":\"912f3ee721a5-71f8b305b8c01e18-ce52\"},\"variable\":\"date\",\"submitTitle\":\"Submit\",\"stringId\":\"stringId_819c792e2e8fa121\",\"layout\":\"vertical\",\"attachment\":[{\"type\":\"AdaptiveCard\",\"cardCode\":\"{\\r\\n    \\\"type\\\": \\\"AdaptiveCard\\\",\\r\\n    \\\"$schema\\\": \\\"http://adaptivecards.io/schemas/adaptive-card.json\\\",\\r\\n    \\\"version\\\": \\\"1.2\\\",\\r\\n    \\\"body\\\": [\\r\\n        {\\r\\n            \\\"type\\\": \\\"TextBlock\\\",\\r\\n            \\\"text\\\": \\\"Please select a date for your first vaccination.\\\",\\r\\n            \\\"wrap\\\": true\\r\\n        },\\r\\n        {\\r\\n            \\\"type\\\": \\\"Input.Date\\\",\\r\\n            \\\"id\\\": \\\"preferredDate\\\",\\r\\n            \\\"value\\\" : scenario.minDateForFirstAppointment,\\r\\n            \\\"min\\\" : scenario.minDateForFirstAppointment\\r\\n        },\\r\\n        {\\r\\n            \\\"type\\\": \\\"ActionSet\\\",\\r\\n            \\\"actions\\\": [\\r\\n                {\\r\\n                    \\\"type\\\": \\\"Action.Submit\\\",\\r\\n                    \\\"title\\\": \\\"Next\\\"\\r\\n                }\\r\\n            ]\\r\\n        }\\r\\n    ]\\r\\n}\"}],\"label\":\"DatePicker\"},{\"id\":\"392c35d563ab-eaff95bb7cda8a1d-0416\",\"type\":\"datasource\",\"designer\":{\"xLocation\":400,\"yLocation\":380,\"next\":\"d60cc29ef803-5dbaba7b8a319ab8-57a7\",\"errorStepId\":\"3581010538e6-56c83c66839581a8-dca2\"},\"dataConnection\":\"\",\"urlBase\":\"'https://graph.microsoft.com/beta/bookingBusinesses/' + scenario.bookingsBusiness + '/calendarView'\",\"urlPath\":\"\",\"urlParams\":\"scenario.dateRange\",\"method\":\"get\",\"headers\":\"{\\r\\n    \\\"Authorization\\\" : \\\"Bearer \\\" + scenario.bearerToken.access_token\\r\\n}\",\"opJson\":true,\"opResolveWithFullResponse\":false,\"label\":\"GetScheduledByDateOnly\",\"response\":\"getScheduledSlots\",\"error\":\"getScheduledSlotsError\"},{\"id\":\"912f3ee721a5-71f8b305b8c01e18-ce52\",\"type\":\"action\",\"label\":\"Action\",\"designer\":{\"xLocation\":400,\"yLocation\":300,\"next\":\"392c35d563ab-eaff95bb7cda8a1d-0416\"},\"onInit\":\"var startdate = moment(scenario.date.preferredDate).format(\\\"YYYY-MM-DDTHH:mm\\\") +'Z';\\r\\nvar enddate = moment(scenario.date.preferredDate).add(1,'days').format(\\\"YYYY-MM-DDTHH:mm\\\")+'Z';\\r\\nscenario.dateRange = 'start=' + startdate + '&end='+ enddate;\\r\\n\"},{\"id\":\"7a191c3102cd-f1b7a302986e8d4a-18c5\",\"type\":\"prompt\",\"dataType\":\"object\",\"designer\":{\"xLocation\":400,\"yLocation\":600,\"next\":\"a1e14838760a-992e73d29a57c1f7-e3b1\"},\"variable\":\"preferredTime\",\"submitTitle\":\"Submit\",\"stringId\":\"stringId_edccbbab65c42b11\",\"label\":\"SlotSelect\",\"layout\":\"vertical\",\"attachment\":[{\"type\":\"AdaptiveCard\",\"cardCode\":\"{\\r\\n    \\\"type\\\": \\\"AdaptiveCard\\\",\\r\\n    \\\"$schema\\\": \\\"http://adaptivecards.io/schemas/adaptive-card.json\\\",\\r\\n    \\\"version\\\": \\\"1.2\\\",\\r\\n    \\\"body\\\": [\\r\\n        {\\r\\n            \\\"type\\\": \\\"TextBlock\\\",\\r\\n            \\\"text\\\": \\\"Please choose your preferred time slot.\\\",\\r\\n            \\\"wrap\\\": true\\r\\n        },\\r\\n        {\\r\\n            \\\"type\\\": \\\"Input.ChoiceSet\\\",\\r\\n            \\\"id\\\": \\\"availSlots\\\",\\r\\n            \\\"placeholder\\\": \\\"Please choose your preferred time slot\\\",\\r\\n            \\\"style\\\": \\\"compact\\\",\\r\\n            \\\"isRequired\\\": true,                         //does not work in v1.2\\r\\n            \\\"errorMessage\\\": \\\"This is a required input\\\", //does not work in v1.2\\r\\n            \\\"choices\\\": scenario.allSlots\\r\\n        }\\r\\n    ],\\r\\n    \\\"actions\\\": [\\r\\n        {\\r\\n            \\\"type\\\": \\\"Action.Submit\\\",\\r\\n            \\\"title\\\": \\\"Next\\\"\\r\\n        }\\r\\n    ]\\r\\n}\"}]},{\"id\":\"c105541ce592-10c589d4ab71e6ff-e904\",\"type\":\"datasource\",\"designer\":{\"xLocation\":991,\"yLocation\":140,\"next\":\"bf2cdf7d14ee-b773d59bcceb7c82-b8b1\",\"errorStepId\":\"d25e7482c68f-bc257d3ea050d754-8c9a\"},\"dataConnection\":\"\",\"urlBase\":\"'https://graph.microsoft.com/beta/bookingBusinesses/' + scenario.bookingsBusiness + '/appointments'\",\"urlPath\":\"\",\"urlParams\":\"\",\"method\":\"post\",\"headers\":\"{\\r\\n    \\\"Authorization\\\" : \\\"Bearer \\\" + scenario.bearerToken.access_token\\r\\n}\",\"opJson\":true,\"opResolveWithFullResponse\":false,\"label\":\"BookAppt\",\"response\":\"createBookingAppointment\",\"error\":\"createBookingAppointmentError\",\"contentType\":\"raw\",\"payload\":\"{\\r\\n  \\\"customerEmailAddress\\\": scenario.bookingEmail,\\r\\n  \\\"customerName\\\": scenario.bookingInfo,\\r\\n  \\\"customerPhone\\\": scenario.bookingPhone,\\r\\n  \\\"serviceId\\\": scenario.bookingBusiness.value[0].id,\\r\\n  \\\"staffMemberIds\\\": scenario.selectedStaffMemberId,\\r\\n  \\\"start\\\": {\\r\\n    \\\"dateTime\\\": scenario.BookingStartDateTime\\r\\n  },\\r\\n  \\\"end\\\": {\\r\\n    \\\"dateTime\\\": scenario.BookingEndDateTime\\r\\n  },\\r\\n  \\\"serviceName\\\":\\\"Covid Vaccine First appointment\\\",\\r\\n  \\\"serviceNotes\\\":\\\"Additional customer Info.\\\",\\r\\n  \\\"customerLocation\\\":{\\r\\n        \\\"@odata.type\\\":\\\"#microsoft.graph.location\\\",\\r\\n        \\\"address\\\":{\\r\\n            \\\"@odata.type\\\":\\\"#microsoft.graph.physicalAddress\\\",\\r\\n            \\\"city\\\":\\\"Buffalo\\\",\\r\\n            \\\"countryOrRegion\\\":\\\"USA\\\",\\r\\n            \\\"postalCode\\\":\\\"98052\\\",\\r\\n            \\\"postOfficeBox\\\":null,\\r\\n            \\\"state\\\":\\\"NY\\\",\\r\\n            \\\"street\\\":\\\"123 First Avenue\\\",\\r\\n            \\\"type@odata.type\\\":\\\"#microsoft.graph.physicalAddressType\\\",\\r\\n            \\\"type\\\":null\\r\\n        }\\r\\n    }\\r\\n}\"},{\"id\":\"a1e14838760a-992e73d29a57c1f7-e3b1\",\"type\":\"action\",\"label\":\"Action\",\"designer\":{\"xLocation\":400,\"yLocation\":680,\"next\":\"d16a44b17272-1902c7734b5a4127-27f2\"},\"onInit\":\"var _ = require('underscore');\\r\\n\\r\\nscenario.BookingStartDateTime = moment(scenario.date.preferredDate+\\\" \\\"+scenario.preferredTime.availSlots).add(6,'hours').format(\\\"YYYY-MM-DDTHH:mm:ss\\\") +'Z';\\r\\nscenario.BookingEndDateTime = moment(scenario.date.preferredDate+\\\" \\\"+scenario.preferredTime.availSlots).add(6,'hours').add(20,'minutes').format(\\\"YYYY-MM-DDTHH:mm:ss\\\") +'Z';\\r\\nscenario.BookingStartDateTime1 = moment(scenario.date.preferredDate+\\\" \\\"+scenario.preferredTime.availSlots).add(1,'seconds').add(6,'hours').format(\\\"YYYY-MM-DDTHH:mm:ss\\\") +'Z';\\r\\n\\r\\n\\r\\n\"},{\"id\":\"d16a44b17272-1902c7734b5a4127-27f2\",\"type\":\"datasource\",\"designer\":{\"xLocation\":400,\"yLocation\":772,\"next\":\"185423bf0c92-4cf763b8e8da3a07-75ee\",\"errorStepId\":\"14efb2408049-6009ab7857f7f9ae-b17b\"},\"dataConnection\":\"\",\"urlBase\":\"'https://graph.microsoft.com/beta/bookingBusinesses/' + scenario.bookingsBusiness + '/calendarView'\",\"urlPath\":\"\",\"urlParams\":\"'start=' + scenario.BookingStartDateTime1 + '&end='+ scenario.BookingEndDateTime\",\"method\":\"get\",\"headers\":\"{\\r\\n    \\\"Authorization\\\" : \\\"Bearer \\\" + scenario.bearerToken.access_token\\r\\n}\",\"opJson\":true,\"opResolveWithFullResponse\":false,\"label\":\"GetScheduledBySelectedDateTime\",\"response\":\"getScheduledBySelectedDateTimeSlots\",\"error\":\"getScheduledBySelectedDateTimeSlotsError\"},{\"id\":\"185423bf0c92-4cf763b8e8da3a07-75ee\",\"type\":\"action\",\"label\":\"SelectStaff\",\"designer\":{\"xLocation\":540,\"yLocation\":754,\"next\":\"3c915cc4f809-7ced167d36c70dd2-b03f\"},\"onInit\":\"var _ = require('underscore');\\r\\n\\r\\nscenario.selectedStaffMemberId = [];\\r\\n//find all the staff for specific booking service\\r\\nvar staffMemberIds = [];\\r\\nstaffMemberIds = scenario.bookingBusiness.value[0].staffMemberIds;\\r\\nif(scenario.getScheduledBySelectedDateTimeSlots.value.length > 0) {\\r\\n    _.each(scenario.getScheduledBySelectedDateTimeSlots.value, function(value){\\r\\n        //remove staff that is already assigned.\\r\\n        staffMemberIds = _.without(staffMemberIds,value.staffMemberIds[0]);\\r\\n    });\\r\\n\\r\\n}\\r\\n//add new staff randomly to create new booking.\\r\\nscenario.selectedStaffMemberId.push(staffMemberIds[0]);\"},{\"id\":\"05b5497242ce-f3b94fb7cb201359-327b\",\"type\":\"statement\",\"designer\":{\"xLocation\":1527,\"yLocation\":871},\"text\":\"Congratulations, you appointment has been booked.\",\"stringId\":\"stringId_a6dec7bcdb2d1cae\"},{\"id\":\"0e94cc4a34b2-7708f03ad4d55116-4d9a\",\"type\":\"action\",\"label\":\"Action\",\"designer\":{\"xLocation\":991,\"yLocation\":287,\"next\":\"316278c15b79-0a836ce9cb1df10e-60e6\"},\"onInit\":\"var startdate = moment(scenario.seconddate.preferredDate).format(\\\"YYYY-MM-DDTHH:mm\\\") +'Z';\\r\\nvar enddate = moment(scenario.seconddate.preferredDate).add(1,'days').format(\\\"YYYY-MM-DDTHH:mm\\\")+'Z';\\r\\nscenario.dateRangeForSecondAppointment = 'start=' + startdate + '&end='+ enddate;\\r\\nscenario.allSlots = scenario.masterSlots;\\r\\nscenario.startdateForSecondAppointment = moment(scenario.seconddate.preferredDate).format(\\\"YYYY-MM-DD\\\");\\r\\n\"},{\"id\":\"316278c15b79-0a836ce9cb1df10e-60e6\",\"type\":\"datasource\",\"designer\":{\"xLocation\":991,\"yLocation\":374,\"next\":\"563543e09cd5-4b3996f9ed066ea2-3f17\",\"errorStepId\":\"a2cd9ce6f419-a417a362cfc3b44b-34b8\"},\"dataConnection\":\"\",\"urlBase\":\"'https://graph.microsoft.com/beta/bookingBusinesses/' + scenario.bookingsBusiness + '/calendarView'\",\"urlPath\":\"\",\"urlParams\":\"scenario.dateRangeForSecondAppointment\",\"method\":\"get\",\"headers\":\"{\\r\\n    \\\"Authorization\\\" : \\\"Bearer \\\" + scenario.bearerToken.access_token\\r\\n}\",\"opJson\":true,\"opResolveWithFullResponse\":false,\"label\":\"GetScheduledByDateOnlyForSecondAppointment\",\"response\":\"getScheduledSlotsForSecondAppointment\",\"error\":\"getScheduledSlotsForSecondAppointmentError\"},{\"id\":\"563543e09cd5-4b3996f9ed066ea2-3f17\",\"type\":\"branch\",\"condition\":\"scenario.getScheduledSlotsForSecondAppointment.value.length > 0\",\"designer\":{\"xLocation\":1000,\"yLocation\":447,\"next\":\"2bab4768c851-a06d2a35ed9be82f-a4d8\"},\"targetStepId\":\"2b3f0d4dd22b-06749d226a3c5b4e-46fb\"},{\"id\":\"2bab4768c851-a06d2a35ed9be82f-a4d8\",\"type\":\"action\",\"label\":\"Action\",\"designer\":{\"xLocation\":891,\"yLocation\":520,\"next\":\"5ea5fd1b4165-eeef9702645bb270-7ccd\"},\"onInit\":\"scenario.allSlots = scenario.allSlots.map(item => ({title:item , value:item }));\"},{\"id\":\"2b3f0d4dd22b-06749d226a3c5b4e-46fb\",\"type\":\"action\",\"label\":\"Action\",\"designer\":{\"xLocation\":1100,\"yLocation\":520,\"next\":\"5ea5fd1b4165-eeef9702645bb270-7ccd\"},\"onInit\":\"var _ = require('underscore');\\r\\nvar timeslots = {};\\r\\n\\r\\n_.each(scenario.getScheduledSlotsForSecondAppointment.value, function(value){\\r\\n     if (!timeslots[moment(value.start.dateTime).subtract(6, 'hours').format('hh:mm A')]) \\r\\n        timeslots[moment(value.start.dateTime).subtract(6, 'hours').format('hh:mm A')] = [];\\r\\n    timeslots[moment(value.start.dateTime).subtract(6, 'hours').format('hh:mm A')].push(value.staffMemberIds[0]);\\r\\n});\\r\\nfor (var key in timeslots) {\\r\\n    // check if the property/key is defined in the object itself, not in parent\\r\\n    if (timeslots.hasOwnProperty(key) && timeslots[key].length == scenario.bookingBusiness.value[0].staffMemberIds.length ) {           \\r\\n        scenario.allSlots = _.without(scenario.allSlots,key);\\r\\n    }\\r\\n}\\r\\nscenario.allSlots = scenario.allSlots.map(item => ({title:item , value:item }));\\r\\n\\r\\n\"},{\"id\":\"5ea5fd1b4165-eeef9702645bb270-7ccd\",\"type\":\"prompt\",\"dataType\":\"object\",\"designer\":{\"xLocation\":991,\"yLocation\":607,\"next\":\"290bafe9f9fa-e1d8f1f49e3e0baa-3b9a\"},\"variable\":\"preferredTimeForSecondAppointment\",\"submitTitle\":\"Submit\",\"stringId\":\"stringId_edccbbab65c42b11\",\"label\":\"SlotSelect\",\"layout\":\"vertical\",\"attachment\":[{\"type\":\"AdaptiveCard\",\"cardCode\":\"{\\r\\n    \\\"type\\\": \\\"AdaptiveCard\\\",\\r\\n    \\\"$schema\\\": \\\"http://adaptivecards.io/schemas/adaptive-card.json\\\",\\r\\n    \\\"version\\\": \\\"1.2\\\",\\r\\n    \\\"body\\\": [\\r\\n        {\\r\\n            \\\"type\\\": \\\"TextBlock\\\",\\r\\n            \\\"text\\\": \\\"Please choose your preferred time slot.\\\",\\r\\n            \\\"wrap\\\": true\\r\\n        },\\r\\n        {\\r\\n            \\\"type\\\": \\\"Input.ChoiceSet\\\",\\r\\n            \\\"id\\\": \\\"availSlots\\\",\\r\\n            \\\"placeholder\\\": \\\"Please choose your preferred time slot\\\",\\r\\n            \\\"style\\\": \\\"compact\\\",\\r\\n            \\\"isRequired\\\": true,                         //does not work in v1.2\\r\\n            \\\"errorMessage\\\": \\\"This is a required input\\\", //does not work in v1.2\\r\\n            \\\"choices\\\": scenario.allSlots\\r\\n        }\\r\\n    ],\\r\\n    \\\"actions\\\": [\\r\\n        {\\r\\n            \\\"type\\\": \\\"Action.Submit\\\",\\r\\n            \\\"title\\\": \\\"Next\\\"\\r\\n        }\\r\\n    ]\\r\\n}\"}]},{\"id\":\"290bafe9f9fa-e1d8f1f49e3e0baa-3b9a\",\"type\":\"action\",\"label\":\"Action\",\"designer\":{\"xLocation\":1000,\"yLocation\":680,\"next\":\"6c98668b0ffe-b63751fb33a82250-ace6\"},\"onInit\":\"var _ = require('underscore');\\r\\n\\r\\nscenario.BookingStartDateTimeForSecondAppointment = moment(scenario.startdateForSecondAppointment+\\\" \\\"+scenario.preferredTime.availSlots).add(6,'hours').format(\\\"YYYY-MM-DDTHH:mm:ss\\\") +'Z';\\r\\nscenario.BookingEndDateTimeForSecondAppointment = moment(scenario.startdateForSecondAppointment+\\\" \\\"+scenario.preferredTime.availSlots).add(6,'hours').add(20,'minutes').format(\\\"YYYY-MM-DDTHH:mm:ss\\\") +'Z';\\r\\nscenario.BookingStartDateTimeForSecondAppointment1 = moment(scenario.startdateForSecondAppointment+\\\" \\\"+scenario.preferredTime.availSlots).add(1,'seconds').add(6,'hours').format(\\\"YYYY-MM-DDTHH:mm:ss\\\") +'Z';\\r\\n\\r\\n\"},{\"id\":\"6c98668b0ffe-b63751fb33a82250-ace6\",\"type\":\"datasource\",\"designer\":{\"xLocation\":991,\"yLocation\":767,\"next\":\"ade2c450a98d-50bb3bf3ce8e23f6-b9e0\",\"errorStepId\":\"7c85251af6d3-5679b8cab1dda753-d343\"},\"dataConnection\":\"\",\"urlBase\":\"'https://graph.microsoft.com/beta/bookingBusinesses/' + scenario.bookingsBusiness + '/calendarView'\",\"urlPath\":\"\",\"urlParams\":\"'start=' + scenario.BookingStartDateTimeForSecondAppointment1 + '&end='+ scenario.BookingEndDateTimeForSecondAppointment\",\"method\":\"get\",\"headers\":\"{\\r\\n    \\\"Authorization\\\" : \\\"Bearer \\\" + scenario.bearerToken.access_token\\r\\n}\",\"opJson\":true,\"opResolveWithFullResponse\":false,\"label\":\"GetScheduledBySelectedDateTimeForSecondAppointment\",\"response\":\"getScheduledBySelectedDateTimeForSecondAptSlots\",\"error\":\"getScheduledBySelectedDateTimeForSecondAptSlotsError\"},{\"id\":\"ade2c450a98d-50bb3bf3ce8e23f6-b9e0\",\"type\":\"action\",\"label\":\"SelectStaff\",\"designer\":{\"xLocation\":1200,\"yLocation\":747,\"next\":\"c48bc3f23d97-8c6616d7fb16b590-95d8\"},\"onInit\":\"var _ = require('underscore');\\r\\n\\r\\nscenario.selectedStaffMemberIdForSecondAppointment = [];\\r\\n//find all the staff for specific booking service\\r\\nscenario.staffMemberIds = [];\\r\\nscenario.staffMemberIds = scenario.bookingBusiness.value[0].staffMemberIds;\\r\\nif(scenario.getScheduledBySelectedDateTimeForSecondAptSlots.value.length > 0) {\\r\\n    _.each(scenario.getScheduledBySelectedDateTimeForSecondAptSlots.value, function(value){\\r\\n        //remove staff that is already assigned.\\r\\n        scenario.staffMemberIds = _.without(scenario.staffMemberIds,value.staffMemberIds[0]);\\r\\n    });\\r\\n\\r\\n}\\r\\n//add new staff randomly to create new booking.\\r\\nscenario.selectedStaffMemberIdForSecondAppointment.push(scenario.staffMemberIds[0]);\\r\\n\\r\\n\"},{\"id\":\"c48bc3f23d97-8c6616d7fb16b590-95d8\",\"type\":\"datasource\",\"designer\":{\"xLocation\":1440,\"yLocation\":789,\"next\":\"05b5497242ce-f3b94fb7cb201359-327b\",\"errorStepId\":\"6cbaab982233-167c2826ba223fbd-3783\"},\"dataConnection\":\"\",\"urlBase\":\"'https://graph.microsoft.com/beta/bookingBusinesses/' + scenario.bookingsBusiness + '/appointments'\",\"urlPath\":\"\",\"urlParams\":\"\",\"method\":\"post\",\"headers\":\"{\\r\\n    \\\"Authorization\\\" : \\\"Bearer \\\" + scenario.bearerToken.access_token\\r\\n}\",\"opJson\":true,\"opResolveWithFullResponse\":false,\"label\":\"BookSecondAppt\",\"response\":\"createBookingForSecondAppointment\",\"error\":\"createBookingForSecondAppointmentError\",\"contentType\":\"raw\",\"payload\":\"{\\r\\n  \\\"customerEmailAddress\\\": scenario.bookingEmail,\\r\\n  \\\"customerName\\\": scenario.bookingInfo,\\r\\n  \\\"customerPhone\\\": scenario.bookingPhone,\\r\\n  \\\"serviceId\\\": scenario.bookingBusiness.value[0].id,\\r\\n  \\\"staffMemberIds\\\": scenario.selectedStaffMemberIdForSecondAppointment,\\r\\n  \\\"start\\\": {\\r\\n    \\\"dateTime\\\": scenario.BookingStartDateTimeForSecondAppointment\\r\\n  },\\r\\n  \\\"end\\\": {\\r\\n    \\\"dateTime\\\": scenario.BookingEndDateTimeForSecondAppointment\\r\\n  },\\r\\n  \\\"serviceName\\\":\\\"Covid Vaccine Second appointment\\\",\\r\\n  \\\"serviceNotes\\\":\\\"Additional customer Info.\\\",\\r\\n  \\\"customerLocation\\\":{\\r\\n        \\\"@odata.type\\\":\\\"#microsoft.graph.location\\\",\\r\\n        \\\"address\\\":{\\r\\n            \\\"@odata.type\\\":\\\"#microsoft.graph.physicalAddress\\\",\\r\\n            \\\"city\\\":\\\"Buffalo\\\",\\r\\n            \\\"countryOrRegion\\\":\\\"USA\\\",\\r\\n            \\\"postalCode\\\":\\\"98052\\\",\\r\\n            \\\"postOfficeBox\\\":null,\\r\\n            \\\"state\\\":\\\"NY\\\",\\r\\n            \\\"street\\\":\\\"123 First Avenue\\\",\\r\\n            \\\"type@odata.type\\\":\\\"#microsoft.graph.physicalAddressType\\\",\\r\\n            \\\"type\\\":null\\r\\n        }\\r\\n    }\\r\\n}\"},{\"id\":\"14efb2408049-6009ab7857f7f9ae-b17b\",\"type\":\"statement\",\"designer\":{\"xLocation\":260,\"yLocation\":814},\"text\":\"I'm so embarrassed, but for whatever reason, I couldn't connect to the API.  Please contact my creator.\",\"stringId\":\"stringId_9c34d3d1b918eaa5\"},{\"id\":\"a674a1c47973-acdec85f7a5e1b21-6b93\",\"type\":\"prompt\",\"dataType\":\"object\",\"designer\":{\"xLocation\":700,\"yLocation\":434,\"next\":\"3c915cc4f809-7ced167d36c70dd2-b03f\"},\"variable\":\"personInfo\",\"submitTitle\":\"Submit\",\"label\":\"PersonInfo\",\"layout\":\"vertical\",\"attachment\":[{\"type\":\"AdaptiveCard\",\"cardCode\":\"{\\r\\n    \\\"$schema\\\": \\\"http://adaptivecards.io/schemas/adaptive-card.json\\\",\\r\\n    \\\"type\\\": \\\"AdaptiveCard\\\",\\r\\n    \\\"version\\\": \\\"1.2\\\",\\r\\n    \\\"body\\\": [\\r\\n        {\\r\\n            \\\"type\\\": \\\"ColumnSet\\\",\\r\\n            \\\"columns\\\": [\\r\\n                {\\r\\n                    \\\"type\\\": \\\"Column\\\",\\r\\n                    \\\"width\\\": 2,\\r\\n                    \\\"items\\\": [\\r\\n                        {\\r\\n                            \\\"type\\\": \\\"TextBlock\\\",\\r\\n                            \\\"text\\\": \\\"Patient/Resident/Customer Information\\\",\\r\\n                            \\\"weight\\\": \\\"Bolder\\\",\\r\\n                            \\\"size\\\": \\\"Medium\\\",\\r\\n                            \\\"horizontalAlignment\\\": \\\"Center\\\"\\r\\n                        },\\r\\n                        {\\r\\n                            \\\"type\\\": \\\"TextBlock\\\",\\r\\n                            \\\"text\\\": \\\"Name\\\",\\r\\n                            \\\"wrap\\\": true,\\r\\n                            \\\"weight\\\": \\\"Bolder\\\"\\r\\n                        },\\r\\n                        {\\r\\n                            \\\"type\\\": \\\"Input.Text\\\",\\r\\n                            \\\"id\\\": \\\"FirstName\\\",\\r\\n                            \\\"placeholder\\\": \\\"First Name\\\"\\r\\n                        },\\r\\n                        {\\r\\n                            \\\"type\\\": \\\"Input.Text\\\",\\r\\n                            \\\"id\\\": \\\"LastName\\\",\\r\\n                            \\\"placeholder\\\": \\\"Last Name\\\"\\r\\n                        },\\r\\n                        {\\r\\n                            \\\"type\\\": \\\"TextBlock\\\",\\r\\n                            \\\"text\\\": \\\"Contact Information\\\",\\r\\n                            \\\"wrap\\\": true,\\r\\n                            \\\"weight\\\": \\\"Bolder\\\"\\r\\n                        },\\r\\n                        {\\r\\n                            \\\"type\\\": \\\"Input.Text\\\",\\r\\n                            \\\"id\\\": \\\"email\\\",\\r\\n                            \\\"style\\\" : \\\"email\\\",\\r\\n                            \\\"placeholder\\\": \\\"Email Address (Required)\\\"\\r\\n                        },\\r\\n                        {\\r\\n                            \\\"type\\\": \\\"Input.Text\\\",\\r\\n                            \\\"id\\\": \\\"phone\\\",\\r\\n                            \\\"style\\\" : \\\"Tel\\\",                            \\r\\n                            \\\"placeholder\\\": \\\"Mobile Phone Number (Optional but Highly Recommended)\\\"\\r\\n                        },                        \\r\\n                        {\\r\\n                            \\\"type\\\": \\\"TextBlock\\\",\\r\\n                            \\\"text\\\": \\\"Date of Birth\\\",\\r\\n                            \\\"wrap\\\": true,\\r\\n                            \\\"weight\\\": \\\"Bolder\\\"\\r\\n                        },\\r\\n                        {\\r\\n                            \\\"type\\\": \\\"Input.Text\\\",\\r\\n                            \\\"id\\\": \\\"DOB\\\",\\r\\n                            \\\"placeholder\\\": \\\"mm/dd/yyyy\\\"\\r\\n                        },\\r\\n                        {\\r\\n                            \\\"type\\\": \\\"TextBlock\\\",\\r\\n                            \\\"text\\\": \\\"Address\\\",\\r\\n                            \\\"wrap\\\": true,\\r\\n                            \\\"weight\\\": \\\"Bolder\\\"\\r\\n                        },\\r\\n                        {\\r\\n                            \\\"type\\\": \\\"Input.Text\\\",\\r\\n                            \\\"placeholder\\\": \\\"Street 1\\\",\\r\\n                            \\\"id\\\": \\\"Street1\\\"\\r\\n                        },\\r\\n                        {\\r\\n                            \\\"type\\\": \\\"Input.Text\\\",\\r\\n                            \\\"placeholder\\\": \\\"Street 2\\\",\\r\\n                            \\\"id\\\": \\\"Street2\\\"\\r\\n                        },\\r\\n                        {\\r\\n                            \\\"type\\\": \\\"Input.Text\\\",\\r\\n                            \\\"placeholder\\\": \\\"City\\\",\\r\\n                            \\\"id\\\": \\\"City\\\"\\r\\n                        },\\r\\n                        {\\r\\n                            \\\"type\\\": \\\"Input.ChoiceSet\\\",\\r\\n                            \\\"choices\\\": scenario.state_list,\\r\\n                            \\\"placeholder\\\": \\\"State\\\",\\r\\n                            \\\"id\\\": \\\"State\\\"\\r\\n                        },\\r\\n                        {\\r\\n                            \\\"type\\\": \\\"Input.Text\\\",\\r\\n                            \\\"placeholder\\\": \\\"Postal (Zip)\\\",\\r\\n                            \\\"id\\\": \\\"Postal\\\"\\r\\n                        }\\r\\n                    ]\\r\\n                }\\r\\n            ]\\r\\n        }\\r\\n    ],\\r\\n    \\\"actions\\\": [\\r\\n        {\\r\\n            \\\"type\\\": \\\"Action.Submit\\\",\\r\\n            \\\"title\\\": \\\"Submit\\\"\\r\\n        }\\r\\n    ]\\r\\n}\"}]},{\"id\":\"3c915cc4f809-7ced167d36c70dd2-b03f\",\"type\":\"action\",\"label\":\"Action\",\"designer\":{\"xLocation\":700,\"yLocation\":560,\"next\":\"c105541ce592-10c589d4ab71e6ff-e904\"},\"onInit\":\"scenario.bookingInfo  = scenario.FirstName + ' ' + scenario.LastName;\\r\\nscenario.bookingEmail = scenario.Email;\\r\\nscenario.bookingPhone = scenario.Phone;\\r\\n\\r\\nscenario.startdate2 = moment(scenario.date.preferredDate).add(21,'days').format(\\\"MM-DD-YYYY\\\");\\r\\nscenario.startdate2a = moment(scenario.date.preferredDate).add(21,'days').format(\\\"YYYY-MM-DD\\\");\"},{\"id\":\"bf2cdf7d14ee-b773d59bcceb7c82-b8b1\",\"type\":\"prompt\",\"dataType\":\"object\",\"designer\":{\"xLocation\":991,\"yLocation\":220,\"next\":\"0e94cc4a34b2-7708f03ad4d55116-4d9a\"},\"variable\":\"seconddate\",\"submitTitle\":\"Submit\",\"stringId\":\"stringId_819c792e2e8fa121\",\"layout\":\"vertical\",\"attachment\":[{\"type\":\"AdaptiveCard\",\"cardCode\":\"{\\r\\n    \\\"type\\\": \\\"AdaptiveCard\\\",\\r\\n    \\\"$schema\\\": \\\"http://adaptivecards.io/schemas/adaptive-card.json\\\",\\r\\n    \\\"version\\\": \\\"1.2\\\",\\r\\n    \\\"body\\\": [\\r\\n        {\\r\\n            \\\"type\\\": \\\"TextBlock\\\",\\r\\n            \\\"text\\\": \\\"Please select a date for your second vaccination.\\\",\\r\\n            \\\"wrap\\\": true\\r\\n        },\\r\\n        {\\r\\n            \\\"type\\\": \\\"Input.Date\\\",\\r\\n            \\\"id\\\": \\\"preferredDate\\\",\\r\\n            \\\"value\\\" : scenario.startdate2a,\\r\\n            \\\"min\\\" : scenario.startdate2a\\r\\n        },\\r\\n        {\\r\\n            \\\"type\\\": \\\"ActionSet\\\",\\r\\n            \\\"actions\\\": [\\r\\n                {\\r\\n                    \\\"type\\\": \\\"Action.Submit\\\",\\r\\n                    \\\"title\\\": \\\"Next\\\"\\r\\n                }\\r\\n            ]\\r\\n        }\\r\\n    ]\\r\\n}\"}],\"label\":\"DatePicker\"},{\"id\":\"6ba0714d6f4d-06ffaad5e2ce7f75-a7fb\",\"type\":\"action\",\"label\":\"States\",\"designer\":{\"xLocation\":709,\"yLocation\":340,\"next\":\"a674a1c47973-acdec85f7a5e1b21-6b93\"},\"onInit\":\"scenario.state_list = [\\n{\\n\\\"name\\\": \\\"Please select a location\\\",\\n\\\"abbreviation\\\": \\\"default_message\\\"\\n},\\n{\\n\\\"name\\\": \\\"Alabama\\\",\\n\\\"abbreviation\\\": \\\"AL\\\"\\n},\\n{\\n\\\"name\\\": \\\"Alaska\\\",\\n\\\"abbreviation\\\": \\\"AK\\\"\\n},\\n{\\n\\\"name\\\": \\\"American Samoa\\\",\\n\\\"abbreviation\\\": \\\"AS\\\"\\n},\\n{\\n\\\"name\\\": \\\"Arizona\\\",\\n\\\"abbreviation\\\": \\\"AZ\\\"\\n},\\n{\\n\\\"name\\\": \\\"Arkansas\\\",\\n\\\"abbreviation\\\": \\\"AR\\\"\\n},\\n{\\n\\\"name\\\": \\\"California\\\",\\n\\\"abbreviation\\\": \\\"CA\\\"\\n},\\n{\\n\\\"name\\\": \\\"California - Los Angeles County\\\",\\n\\\"abbreviation\\\": \\\"Los_Angeles\\\"\\n},\\n{\\n\\\"name\\\": \\\"Colorado\\\",\\n\\\"abbreviation\\\": \\\"CO\\\"\\n},\\n{\\n\\\"name\\\": \\\"Connecticut\\\",\\n\\\"abbreviation\\\": \\\"CT\\\"\\n},\\n{\\n\\\"name\\\": \\\"Delaware\\\",\\n\\\"abbreviation\\\": \\\"DE\\\"\\n},\\n{\\n\\\"name\\\": \\\"District Of Columbia\\\",\\n\\\"abbreviation\\\": \\\"DC\\\"\\n},\\n{\\n\\\"name\\\": \\\"Federated States Of Micronesia\\\",\\n\\\"abbreviation\\\": \\\"FM\\\"\\n},\\n{\\n\\\"name\\\": \\\"Florida\\\",\\n\\\"abbreviation\\\": \\\"FL\\\"\\n},\\n{\\n\\\"name\\\": \\\"Georgia\\\",\\n\\\"abbreviation\\\": \\\"GA\\\"\\n},\\n{\\n\\\"name\\\": \\\"Guam\\\",\\n\\\"abbreviation\\\": \\\"GU\\\"\\n},\\n{\\n\\\"name\\\": \\\"Hawaii\\\",\\n\\\"abbreviation\\\": \\\"HI\\\"\\n},\\n{\\n\\\"name\\\": \\\"Idaho\\\",\\n\\\"abbreviation\\\": \\\"ID\\\"\\n},\\n{\\n\\\"name\\\": \\\"Illinois\\\",\\n\\\"abbreviation\\\": \\\"IL\\\"\\n},\\n{\\n\\\"name\\\": \\\"Illinois – Chicago\\\",\\n\\\"abbreviation\\\": \\\"Chicago\\\"\\n},\\n{\\n\\\"name\\\": \\\"Indiana\\\",\\n\\\"abbreviation\\\": \\\"IN\\\"\\n},\\n{\\n\\\"name\\\": \\\"Iowa\\\",\\n\\\"abbreviation\\\": \\\"IA\\\"\\n},\\n{\\n\\\"name\\\": \\\"Kansas\\\",\\n\\\"abbreviation\\\": \\\"KS\\\"\\n},\\n{\\n\\\"name\\\": \\\"Kentucky\\\",\\n\\\"abbreviation\\\": \\\"KY\\\"\\n},\\n{\\n\\\"name\\\": \\\"Louisiana\\\",\\n\\\"abbreviation\\\": \\\"LA\\\"\\n},\\n{\\n\\\"name\\\": \\\"Maine\\\",\\n\\\"abbreviation\\\": \\\"ME\\\"\\n},\\n{\\n\\\"name\\\": \\\"Marshall Islands\\\",\\n\\\"abbreviation\\\": \\\"MH\\\"\\n},\\n{\\n\\\"name\\\": \\\"Maryland\\\",\\n\\\"abbreviation\\\": \\\"MD\\\"\\n},\\n{\\n\\\"name\\\": \\\"Massachusetts\\\",\\n\\\"abbreviation\\\": \\\"MA\\\"\\n},\\n{\\n\\\"name\\\": \\\"Michigan\\\",\\n\\\"abbreviation\\\": \\\"MI\\\"\\n},\\n{\\n\\\"name\\\": \\\"Minnesota\\\",\\n\\\"abbreviation\\\": \\\"MN\\\"\\n},\\n{\\n\\\"name\\\": \\\"Mississippi\\\",\\n\\\"abbreviation\\\": \\\"MS\\\"\\n},\\n{\\n\\\"name\\\": \\\"Missouri\\\",\\n\\\"abbreviation\\\": \\\"MO\\\"\\n},\\n{\\n\\\"name\\\": \\\"Montana\\\",\\n\\\"abbreviation\\\": \\\"MT\\\"\\n},\\n{\\n\\\"name\\\": \\\"Nebraska\\\",\\n\\\"abbreviation\\\": \\\"NE\\\"\\n},\\n{\\n\\\"name\\\": \\\"Nevada\\\",\\n\\\"abbreviation\\\": \\\"NV\\\"\\n},\\n{\\n\\\"name\\\": \\\"New Hampshire\\\",\\n\\\"abbreviation\\\": \\\"NH\\\"\\n},\\n{\\n\\\"name\\\": \\\"New Jersey\\\",\\n\\\"abbreviation\\\": \\\"NJ\\\"\\n},\\n{\\n\\\"name\\\": \\\"New Mexico\\\",\\n\\\"abbreviation\\\": \\\"NM\\\"\\n},\\n{\\n\\\"name\\\": \\\"New York\\\",\\n\\\"abbreviation\\\": \\\"NY\\\"\\n},\\n{\\n\\\"name\\\": \\\"New York – New York City\\\",\\n\\\"abbreviation\\\": \\\"New_York_City\\\"\\n},\\n{\\n\\\"name\\\": \\\"North Carolina\\\",\\n\\\"abbreviation\\\": \\\"NC\\\"\\n},\\n{\\n\\\"name\\\": \\\"North Dakota\\\",\\n\\\"abbreviation\\\": \\\"ND\\\"\\n},\\n{\\n\\\"name\\\": \\\"Northern Mariana Islands\\\",\\n\\\"abbreviation\\\": \\\"MP\\\"\\n},\\n{\\n\\\"name\\\": \\\"Ohio\\\",\\n\\\"abbreviation\\\": \\\"OH\\\"\\n},\\n{\\n\\\"name\\\": \\\"Oklahoma\\\",\\n\\\"abbreviation\\\": \\\"OK\\\"\\n},\\n{\\n\\\"name\\\": \\\"Oregon\\\",\\n\\\"abbreviation\\\": \\\"OR\\\"\\n},\\n{\\n\\\"name\\\": \\\"Palau\\\",\\n\\\"abbreviation\\\": \\\"PW\\\"\\n},\\n{\\n\\\"name\\\": \\\"Pennsylvania\\\",\\n\\\"abbreviation\\\": \\\"PA\\\"\\n},\\n{\\n\\\"name\\\": \\\"Puerto Rico\\\",\\n\\\"abbreviation\\\": \\\"PR\\\"\\n},\\n{\\n\\\"name\\\": \\\"Rhode Island\\\",\\n\\\"abbreviation\\\": \\\"RI\\\"\\n},\\n{\\n\\\"name\\\": \\\"South Carolina\\\",\\n\\\"abbreviation\\\": \\\"SC\\\"\\n},\\n{\\n\\\"name\\\": \\\"South Dakota\\\",\\n\\\"abbreviation\\\": \\\"SD\\\"\\n},\\n{\\n\\\"name\\\": \\\"Tennessee\\\",\\n\\\"abbreviation\\\": \\\"TN\\\"\\n},\\n{\\n\\\"name\\\": \\\"Texas\\\",\\n\\\"abbreviation\\\": \\\"TX\\\"\\n},\\n{\\n\\\"name\\\": \\\"Utah\\\",\\n\\\"abbreviation\\\": \\\"UT\\\"\\n},\\n{\\n\\\"name\\\": \\\"Vermont\\\",\\n\\\"abbreviation\\\": \\\"VT\\\"\\n},\\n{\\n\\\"name\\\": \\\"Virgin Islands\\\",\\n\\\"abbreviation\\\": \\\"VI\\\"\\n},\\n{\\n\\\"name\\\": \\\"Virginia\\\",\\n\\\"abbreviation\\\": \\\"VA\\\"\\n},\\n{\\n\\\"name\\\": \\\"Washington\\\",\\n\\\"abbreviation\\\": \\\"WA\\\"\\n},\\n{\\n\\\"name\\\": \\\"West Virginia\\\",\\n\\\"abbreviation\\\": \\\"WV\\\"\\n},\\n{\\n\\\"name\\\": \\\"Wisconsin\\\",\\n\\\"abbreviation\\\": \\\"WI\\\"\\n},\\n{\\n\\\"name\\\": \\\"Wyoming\\\",\\n\\\"abbreviation\\\": \\\"WY\\\"\\n}\\n].map(item => ({title:item.name , value:item.abbreviation }))\"},{\"id\":\"a2cd9ce6f419-a417a362cfc3b44b-34b8\",\"type\":\"statement\",\"designer\":{\"xLocation\":871,\"yLocation\":407},\"text\":\"I'm so embarrassed, but for whatever reason, I couldn't connect to the API.  Please contact my creator.\",\"stringId\":\"stringId_9c34d3d1b918eaa5\"},{\"id\":\"d25e7482c68f-bc257d3ea050d754-8c9a\",\"type\":\"statement\",\"designer\":{\"xLocation\":820,\"yLocation\":180},\"text\":\"I'm so embarrassed, but for whatever reason, I couldn't connect to the API.  Please contact my creator.\",\"stringId\":\"stringId_9c34d3d1b918eaa5\"},{\"id\":\"6cbaab982233-167c2826ba223fbd-3783\",\"type\":\"statement\",\"designer\":{\"xLocation\":1287,\"yLocation\":860},\"text\":\"I'm so embarrassed, but for whatever reason, I couldn't connect to the API.  Please contact my creator.\",\"stringId\":\"stringId_9c34d3d1b918eaa5\"},{\"id\":\"7c85251af6d3-5679b8cab1dda753-d343\",\"type\":\"statement\",\"designer\":{\"xLocation\":831,\"yLocation\":787},\"text\":\"I'm so embarrassed, but for whatever reason, I couldn't connect to the API.  Please contact my creator.\",\"stringId\":\"stringId_9c34d3d1b918eaa5\"},{\"id\":\"3581010538e6-56c83c66839581a8-dca2\",\"type\":\"statement\",\"designer\":{\"xLocation\":251,\"yLocation\":408},\"text\":\"I'm so embarrassed, but for whatever reason, I couldn't connect to the API.  Please contact my creator.\",\"stringId\":\"stringId_9c34d3d1b918eaa5\"},{\"id\":\"3ab45f7ea637-3686ab7450d24a52-8142\",\"type\":\"statement\",\"designer\":{\"xLocation\":249,\"yLocation\":260},\"text\":\"I'm so embarrassed, but for whatever reason, I couldn't connect to the API.  Please contact my creator.\",\"stringId\":\"stringId_9c34d3d1b918eaa5\"},{\"id\":\"33e079c70c42-e194f352e53a81d7-b79a\",\"type\":\"action\",\"label\":\"Manual\",\"designer\":{\"xLocation\":66,\"yLocation\":147,\"next\":\"82124b7cc880-2adf174fd09712de-8fb2\"},\"onInit\":\"scenario.scope = getEnv(\\\"scope\\\");\\nscenario.clientid = getEnv(\\\"bookingsClientID\\\"); // From App Registration\\nscenario.clientsecret = getEnv(\\\"bookingsClientSecret\\\"); // From App Registration\\nscenario.username = getEnv(\\\"bookingsUsername\\\"); // Admin Account with Access to the Shift Schedule\\nscenario.password = getEnv(\\\"bookingsPassword\\\");\\nscenario.granttype = 'password';\\nscenario.minDateForFirstAppointment = moment().add(1,'days').format(\\\"YYYY-MM-DD\\\");\\nscenario.bookingsServiceName = getEnv(\\\"bookingsServiceName\\\");\\nscenario.bookingsBusiness = getEnv(\\\"bookingsBusiness\\\");\\nscenario.TenantID = getEnv(\\\"tenantID\\\");\\n \\n//'https://graph.microsoft.com/beta/bookingBusinesses/' + scenario.bookingsBusiness + '/services'\\n\\n\\nscenario.manualExec = 'Y';\\nscenario.lat        = 47.673988;\\nscenario.lng        = -122.121513;\\nscenario.phase      = '1a';\\nscenario.usePostal  = 'N';\\nscenario.postal     = '54449';\\nscenario.FirstName  = 'gg'\\nscenario.LastName   = 'gg';\\nscenario.DOB        = '1961-01-01';\\nscenario.Email      = 'gg@gg.com';\\nscenario.Phone      = '555-155-5555';\\nscenario.Street1    = '';\\nscenario.Street2    = '';\\nscenario.City       = '';\\nscenario.State      = 'AL';\\n\\nscenario.bookingInfo = scenario.FirstName + ' ' + scenario.LastName + ' DOB: ' + scenario.DOB;\\n\\n\\nscenario.masterSlots = [\\n\\\"8:00 AM\\\",\\n\\\"8:20 AM\\\",\\n\\\"8:40 AM\\\",\\n\\\"9:00 AM\\\",\\n\\\"9:20 AM\\\",\\n\\\"9:40 AM\\\",\\n\\\"10:00 AM\\\",\\n\\\"10:20 AM\\\",\\n\\\"10:40 AM\\\",\\n\\\"11:00 AM\\\",\\n\\\"11:20 AM\\\",\\n\\\"11:40 AM\\\",\\n\\\"12:00 AM\\\",\\n\\\"12:20 PM\\\",\\n\\\"12:40 PM\\\",\\n\\\"1:00 PM\\\",\\n\\\"1:20 PM\\\",\\n\\\"1:40 PM\\\",\\n\\\"2:00 PM\\\",\\n\\\"2:20 PM\\\",\\n\\\"2:40 PM\\\",\\n\\\"3:00 PM\\\",\\n\\\"3:20 PM\\\",\\n\\\"3:40 PM\\\",\\n\\\"4:00 PM\\\",\\n\\\"4:20 PM\\\",\\n\\\"4:40 PM\\\",\\n\\\"5:00 PM\\\",\\n];\\n\\nscenario.allSlots = scenario.masterSlots;\"},{\"id\":\"82124b7cc880-2adf174fd09712de-8fb2\",\"type\":\"action\",\"label\":\"States\",\"designer\":{\"xLocation\":66,\"yLocation\":260,\"next\":\"83549b07214d-14b4875cd54d4305-e135\"},\"onInit\":\"scenario.state_list = [\\n{\\n\\\"name\\\": \\\"Please select a location\\\",\\n\\\"abbreviation\\\": \\\"default_message\\\"\\n},\\n{\\n\\\"name\\\": \\\"Alabama\\\",\\n\\\"abbreviation\\\": \\\"AL\\\"\\n},\\n{\\n\\\"name\\\": \\\"Alaska\\\",\\n\\\"abbreviation\\\": \\\"AK\\\"\\n},\\n{\\n\\\"name\\\": \\\"American Samoa\\\",\\n\\\"abbreviation\\\": \\\"AS\\\"\\n},\\n{\\n\\\"name\\\": \\\"Arizona\\\",\\n\\\"abbreviation\\\": \\\"AZ\\\"\\n},\\n{\\n\\\"name\\\": \\\"Arkansas\\\",\\n\\\"abbreviation\\\": \\\"AR\\\"\\n},\\n{\\n\\\"name\\\": \\\"California\\\",\\n\\\"abbreviation\\\": \\\"CA\\\"\\n},\\n{\\n\\\"name\\\": \\\"California - Los Angeles County\\\",\\n\\\"abbreviation\\\": \\\"Los_Angeles\\\"\\n},\\n{\\n\\\"name\\\": \\\"Colorado\\\",\\n\\\"abbreviation\\\": \\\"CO\\\"\\n},\\n{\\n\\\"name\\\": \\\"Connecticut\\\",\\n\\\"abbreviation\\\": \\\"CT\\\"\\n},\\n{\\n\\\"name\\\": \\\"Delaware\\\",\\n\\\"abbreviation\\\": \\\"DE\\\"\\n},\\n{\\n\\\"name\\\": \\\"District Of Columbia\\\",\\n\\\"abbreviation\\\": \\\"DC\\\"\\n},\\n{\\n\\\"name\\\": \\\"Federated States Of Micronesia\\\",\\n\\\"abbreviation\\\": \\\"FM\\\"\\n},\\n{\\n\\\"name\\\": \\\"Florida\\\",\\n\\\"abbreviation\\\": \\\"FL\\\"\\n},\\n{\\n\\\"name\\\": \\\"Georgia\\\",\\n\\\"abbreviation\\\": \\\"GA\\\"\\n},\\n{\\n\\\"name\\\": \\\"Guam\\\",\\n\\\"abbreviation\\\": \\\"GU\\\"\\n},\\n{\\n\\\"name\\\": \\\"Hawaii\\\",\\n\\\"abbreviation\\\": \\\"HI\\\"\\n},\\n{\\n\\\"name\\\": \\\"Idaho\\\",\\n\\\"abbreviation\\\": \\\"ID\\\"\\n},\\n{\\n\\\"name\\\": \\\"Illinois\\\",\\n\\\"abbreviation\\\": \\\"IL\\\"\\n},\\n{\\n\\\"name\\\": \\\"Illinois – Chicago\\\",\\n\\\"abbreviation\\\": \\\"Chicago\\\"\\n},\\n{\\n\\\"name\\\": \\\"Indiana\\\",\\n\\\"abbreviation\\\": \\\"IN\\\"\\n},\\n{\\n\\\"name\\\": \\\"Iowa\\\",\\n\\\"abbreviation\\\": \\\"IA\\\"\\n},\\n{\\n\\\"name\\\": \\\"Kansas\\\",\\n\\\"abbreviation\\\": \\\"KS\\\"\\n},\\n{\\n\\\"name\\\": \\\"Kentucky\\\",\\n\\\"abbreviation\\\": \\\"KY\\\"\\n},\\n{\\n\\\"name\\\": \\\"Louisiana\\\",\\n\\\"abbreviation\\\": \\\"LA\\\"\\n},\\n{\\n\\\"name\\\": \\\"Maine\\\",\\n\\\"abbreviation\\\": \\\"ME\\\"\\n},\\n{\\n\\\"name\\\": \\\"Marshall Islands\\\",\\n\\\"abbreviation\\\": \\\"MH\\\"\\n},\\n{\\n\\\"name\\\": \\\"Maryland\\\",\\n\\\"abbreviation\\\": \\\"MD\\\"\\n},\\n{\\n\\\"name\\\": \\\"Massachusetts\\\",\\n\\\"abbreviation\\\": \\\"MA\\\"\\n},\\n{\\n\\\"name\\\": \\\"Michigan\\\",\\n\\\"abbreviation\\\": \\\"MI\\\"\\n},\\n{\\n\\\"name\\\": \\\"Minnesota\\\",\\n\\\"abbreviation\\\": \\\"MN\\\"\\n},\\n{\\n\\\"name\\\": \\\"Mississippi\\\",\\n\\\"abbreviation\\\": \\\"MS\\\"\\n},\\n{\\n\\\"name\\\": \\\"Missouri\\\",\\n\\\"abbreviation\\\": \\\"MO\\\"\\n},\\n{\\n\\\"name\\\": \\\"Montana\\\",\\n\\\"abbreviation\\\": \\\"MT\\\"\\n},\\n{\\n\\\"name\\\": \\\"Nebraska\\\",\\n\\\"abbreviation\\\": \\\"NE\\\"\\n},\\n{\\n\\\"name\\\": \\\"Nevada\\\",\\n\\\"abbreviation\\\": \\\"NV\\\"\\n},\\n{\\n\\\"name\\\": \\\"New Hampshire\\\",\\n\\\"abbreviation\\\": \\\"NH\\\"\\n},\\n{\\n\\\"name\\\": \\\"New Jersey\\\",\\n\\\"abbreviation\\\": \\\"NJ\\\"\\n},\\n{\\n\\\"name\\\": \\\"New Mexico\\\",\\n\\\"abbreviation\\\": \\\"NM\\\"\\n},\\n{\\n\\\"name\\\": \\\"New York\\\",\\n\\\"abbreviation\\\": \\\"NY\\\"\\n},\\n{\\n\\\"name\\\": \\\"New York – New York City\\\",\\n\\\"abbreviation\\\": \\\"New_York_City\\\"\\n},\\n{\\n\\\"name\\\": \\\"North Carolina\\\",\\n\\\"abbreviation\\\": \\\"NC\\\"\\n},\\n{\\n\\\"name\\\": \\\"North Dakota\\\",\\n\\\"abbreviation\\\": \\\"ND\\\"\\n},\\n{\\n\\\"name\\\": \\\"Northern Mariana Islands\\\",\\n\\\"abbreviation\\\": \\\"MP\\\"\\n},\\n{\\n\\\"name\\\": \\\"Ohio\\\",\\n\\\"abbreviation\\\": \\\"OH\\\"\\n},\\n{\\n\\\"name\\\": \\\"Oklahoma\\\",\\n\\\"abbreviation\\\": \\\"OK\\\"\\n},\\n{\\n\\\"name\\\": \\\"Oregon\\\",\\n\\\"abbreviation\\\": \\\"OR\\\"\\n},\\n{\\n\\\"name\\\": \\\"Palau\\\",\\n\\\"abbreviation\\\": \\\"PW\\\"\\n},\\n{\\n\\\"name\\\": \\\"Pennsylvania\\\",\\n\\\"abbreviation\\\": \\\"PA\\\"\\n},\\n{\\n\\\"name\\\": \\\"Puerto Rico\\\",\\n\\\"abbreviation\\\": \\\"PR\\\"\\n},\\n{\\n\\\"name\\\": \\\"Rhode Island\\\",\\n\\\"abbreviation\\\": \\\"RI\\\"\\n},\\n{\\n\\\"name\\\": \\\"South Carolina\\\",\\n\\\"abbreviation\\\": \\\"SC\\\"\\n},\\n{\\n\\\"name\\\": \\\"South Dakota\\\",\\n\\\"abbreviation\\\": \\\"SD\\\"\\n},\\n{\\n\\\"name\\\": \\\"Tennessee\\\",\\n\\\"abbreviation\\\": \\\"TN\\\"\\n},\\n{\\n\\\"name\\\": \\\"Texas\\\",\\n\\\"abbreviation\\\": \\\"TX\\\"\\n},\\n{\\n\\\"name\\\": \\\"Utah\\\",\\n\\\"abbreviation\\\": \\\"UT\\\"\\n},\\n{\\n\\\"name\\\": \\\"Vermont\\\",\\n\\\"abbreviation\\\": \\\"VT\\\"\\n},\\n{\\n\\\"name\\\": \\\"Virgin Islands\\\",\\n\\\"abbreviation\\\": \\\"VI\\\"\\n},\\n{\\n\\\"name\\\": \\\"Virginia\\\",\\n\\\"abbreviation\\\": \\\"VA\\\"\\n},\\n{\\n\\\"name\\\": \\\"Washington\\\",\\n\\\"abbreviation\\\": \\\"WA\\\"\\n},\\n{\\n\\\"name\\\": \\\"West Virginia\\\",\\n\\\"abbreviation\\\": \\\"WV\\\"\\n},\\n{\\n\\\"name\\\": \\\"Wisconsin\\\",\\n\\\"abbreviation\\\": \\\"WI\\\"\\n},\\n{\\n\\\"name\\\": \\\"Wyoming\\\",\\n\\\"abbreviation\\\": \\\"WY\\\"\\n}\\n].map(item => ({title:item.name , value:item.abbreviation }))\"}],\"interrupting\":false,\"breaking\":false,\"returningMessage\":\"\"}"
}