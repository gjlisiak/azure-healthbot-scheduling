{
 "name": "C19 Scheduling - Shifts",
 "id": "1b95cf81-5d3d-4d92-9089-3cda099bf00e",
 "scenario_trigger": "sched_shifts",
 "description": "Demonstration of  scheduling integration via Shifts in Teams",
 "active": true,
 "updated": "2021-02-10T13:16:44.2900000Z",
 "userDisplayName": "Gregory Lisiak",
 "code": "{\"version\":3,\"steps\":[{\"id\":\"e6ae055292b0-a644a58f6932b59d-1305\",\"type\":\"action\",\"label\":\"Action\",\"designer\":{\"xLocation\":54,\"yLocation\":40,\"next\":\"83549b07214d-14b4875cd54d4305-e135\"},\"onInit\":\"scenario.scope = getEnv(\\\"scope\\\");\\nscenario.clientid = getEnv(\\\"shiftsClientID\\\"); // From App Registration\\nscenario.clientsecret = getEnv(\\\"shiftsClientSecret\\\"); // From App Registration\\nscenario.username = getEnv(\\\"shiftsUsername\\\"); // Admin Account with Access to the Shift Schedule\\nscenario.password = getEnv(\\\"shiftsPassword\\\");    \\nscenario.granttype = 'password';\\nscenario.ShiftGroupID = getEnv(\\\"shiftsGroupID\\\");\\nscenario.ShiftsTeamID = getEnv(\\\"shiftsTeamID\\\");\\nscenario.TenantID = getEnv(\\\"tenantID\\\");\\n\\nscenario.minDateForFirstAppointment = moment().add(1,'days').format(\\\"YYYY-MM-DD\\\");\\n\\nscenario.manualExec = scenario.scenarioArgs.manualExec;\\nscenario.lat        = scenario.scenarioArgs.lat;\\nscenario.lng        = scenario.scenarioArgs.lng;\\nscenario.phase      = scenario.scenarioArgs.phase;\\nscenario.usePostal  = scenario.scenarioArgs.usePostal;\\nscenario.postalCode = scenario.scenarioArgs.postalCode;\\nscenario.FirstName  = scenario.scenarioArgs.FirstName;\\nscenario.LastName   = scenario.scenarioArgs.LastName;\\nscenario.DOB        = scenario.scenarioArgs.DOB;\\nscenario.Email      = scenario.scenarioArgs.Email;\\nscenario.Phone      = scenario.scenarioArgs.Phone;\\nscenario.Street1    = scenario.scenarioArgs.Street1;\\nscenario.Street2    = scenario.scenarioArgs.Street2;\\nscenario.City       = scenario.scenarioArgs.City;\\nscenario.State      = scenario.scenarioArgs.State;\\n\\nscenario.bookingInfo = scenario.FirstName + ' ' + scenario.LastName + ' DOB: ' + scenario.DOB;\\n\\n\\nscenario.masterSlots = [\\n\\\"8:00 AM\\\",\\n\\\"8:20 AM\\\",\\n\\\"8:40 AM\\\",\\n\\\"9:00 AM\\\",\\n\\\"9:20 AM\\\",\\n\\\"9:40 AM\\\",\\n\\\"10:00 AM\\\",\\n\\\"10:20 AM\\\",\\n\\\"10:40 AM\\\",\\n\\\"11:00 AM\\\",\\n\\\"11:20 AM\\\",\\n\\\"11:40 AM\\\",\\n\\\"12:00 AM\\\",\\n\\\"12:20 PM\\\",\\n\\\"12:40 PM\\\",\\n\\\"1:00 PM\\\",\\n\\\"1:20 PM\\\",\\n\\\"1:40 PM\\\",\\n\\\"2:00 PM\\\",\\n\\\"2:20 PM\\\",\\n\\\"2:40 PM\\\",\\n\\\"3:00 PM\\\",\\n\\\"3:20 PM\\\",\\n\\\"3:40 PM\\\",\\n\\\"4:00 PM\\\",\\n\\\"4:20 PM\\\",\\n\\\"4:40 PM\\\",\\n\\\"5:00 PM\\\",\\n];\\n\\nscenario.allSlots = scenario.masterSlots;\"},{\"id\":\"83549b07214d-14b4875cd54d4305-e135\",\"type\":\"datasource\",\"designer\":{\"xLocation\":350,\"yLocation\":88,\"next\":\"13987a8d4dd3-90cbd931e53ee4a6-8dfe\",\"errorStepId\":\"cab59e6f097d-06ef0cbf11176232-ded2\"},\"dataConnection\":\"\",\"urlBase\":\"'https://login.microsoftonline.com/'+scenario.TenantID +'/oauth2/v2.0/token'\",\"urlPath\":\"\",\"urlParams\":\"\",\"contentType\":\"x-www-form-urlencoded\",\"method\":\"post\",\"headers\":\"\",\"payload\":\"{\\r\\n\\\"grant_type\\\" : scenario.granttype,\\r\\n\\\"username\\\" : scenario.username,\\r\\n\\\"password\\\" : scenario.password,\\r\\n\\\"client_id\\\" : scenario.clientid,\\r\\n\\\"client_secret\\\" : scenario.clientsecret,\\r\\n\\\"scope\\\" : scenario.scope\\r\\n}\",\"opJson\":true,\"opResolveWithFullResponse\":false,\"response\":\"bearerToken\",\"error\":\"tokenError\",\"label\":\"GetToken\"},{\"id\":\"13987a8d4dd3-90cbd931e53ee4a6-8dfe\",\"type\":\"datasource\",\"designer\":{\"xLocation\":350,\"yLocation\":140,\"next\":\"238111337e8e-b1c29490a8866d3b-8027\",\"errorStepId\":\"c5f86e9d10b7-f553189227aa2776-1626\"},\"dataConnection\":\"\",\"urlBase\":\"'https://graph.microsoft.com/v1.0/teams/' + scenario.ShiftsTeamID + '/schedule/schedulingGroups/'+scenario.ShiftGroupID\",\"urlPath\":\"\",\"urlParams\":\"\",\"method\":\"get\",\"headers\":\"{\\r\\n    \\\"Authorization\\\" : \\\"Bearer \\\" + scenario.bearerToken.access_token\\r\\n}\",\"opJson\":true,\"opResolveWithFullResponse\":false,\"label\":\"GetSchedulingGroupById\",\"response\":\"getSchedulingGroup\",\"error\":\"getSchedulingGroupError\"},{\"id\":\"238111337e8e-b1c29490a8866d3b-8027\",\"type\":\"prompt\",\"dataType\":\"object\",\"designer\":{\"xLocation\":347,\"yLocation\":200,\"next\":\"515ea0237e93-5a86404fb9b00623-1884\"},\"variable\":\"date\",\"submitTitle\":\"Submit\",\"stringId\":\"stringId_819c792e2e8fa121\",\"layout\":\"vertical\",\"attachment\":[{\"type\":\"AdaptiveCard\",\"cardCode\":\"{\\r\\n    \\\"type\\\": \\\"AdaptiveCard\\\",\\r\\n    \\\"$schema\\\": \\\"http://adaptivecards.io/schemas/adaptive-card.json\\\",\\r\\n    \\\"version\\\": \\\"1.2\\\",\\r\\n    \\\"body\\\": [\\r\\n        {\\r\\n            \\\"type\\\": \\\"TextBlock\\\",\\r\\n            \\\"text\\\": \\\"Please select a date for your first vaccination.\\\",\\r\\n            \\\"wrap\\\": true\\r\\n        },\\r\\n        {\\r\\n            \\\"type\\\": \\\"Input.Date\\\",\\r\\n            \\\"id\\\": \\\"preferredDate\\\",\\r\\n            \\\"value\\\": scenario.minDateForFirstAppointment,\\r\\n            \\\"min\\\": scenario.minDateForFirstAppointment\\r\\n        },\\r\\n        {\\r\\n            \\\"type\\\": \\\"ActionSet\\\",\\r\\n            \\\"actions\\\": [\\r\\n                {\\r\\n                    \\\"type\\\": \\\"Action.Submit\\\",\\r\\n                    \\\"title\\\": \\\"Next\\\"\\r\\n                }\\r\\n            ]\\r\\n        }\\r\\n    ]\\r\\n}\"}],\"label\":\"DatePicker\"},{\"id\":\"7a0b0ee7f2cc-e9627e1f52688157-fef5\",\"type\":\"action\",\"label\":\"Action\",\"designer\":{\"xLocation\":350,\"yLocation\":432,\"next\":\"99347383af17-b4d6ad15a6baa959-482e\"},\"onInit\":\"var _ = require('underscore');\\r\\nvar count = 0;\\r\\nscenario.isAppointmentTimeAvailable = false;\\r\\n_.each(scenario.getOpenShifts.value, function(value){\\r\\n    if(value.sharedOpenShift.openSlotCount > 0 )\\r\\n        count++;\\r\\n    if(count > 0) {\\r\\n        scenario.isAppointmentTimeAvailable = true;\\r\\n        return count;\\r\\n    }\\r\\n        \\r\\n});\\r\\n\\r\\n\\r\\n\"},{\"id\":\"2212a4688881-d1d71aef13d1598e-9816\",\"type\":\"action\",\"label\":\"States\",\"designer\":{\"xLocation\":49,\"yLocation\":233,\"next\":\"83549b07214d-14b4875cd54d4305-e135\"},\"onInit\":\"scenario.state_list = [\\n{\\n\\\"name\\\": \\\"Please select a location\\\",\\n\\\"abbreviation\\\": \\\"default_message\\\"\\n},\\n{\\n\\\"name\\\": \\\"Alabama\\\",\\n\\\"abbreviation\\\": \\\"AL\\\"\\n},\\n{\\n\\\"name\\\": \\\"Alaska\\\",\\n\\\"abbreviation\\\": \\\"AK\\\"\\n},\\n{\\n\\\"name\\\": \\\"American Samoa\\\",\\n\\\"abbreviation\\\": \\\"AS\\\"\\n},\\n{\\n\\\"name\\\": \\\"Arizona\\\",\\n\\\"abbreviation\\\": \\\"AZ\\\"\\n},\\n{\\n\\\"name\\\": \\\"Arkansas\\\",\\n\\\"abbreviation\\\": \\\"AR\\\"\\n},\\n{\\n\\\"name\\\": \\\"California\\\",\\n\\\"abbreviation\\\": \\\"CA\\\"\\n},\\n{\\n\\\"name\\\": \\\"California - Los Angeles County\\\",\\n\\\"abbreviation\\\": \\\"Los_Angeles\\\"\\n},\\n{\\n\\\"name\\\": \\\"Colorado\\\",\\n\\\"abbreviation\\\": \\\"CO\\\"\\n},\\n{\\n\\\"name\\\": \\\"Connecticut\\\",\\n\\\"abbreviation\\\": \\\"CT\\\"\\n},\\n{\\n\\\"name\\\": \\\"Delaware\\\",\\n\\\"abbreviation\\\": \\\"DE\\\"\\n},\\n{\\n\\\"name\\\": \\\"District Of Columbia\\\",\\n\\\"abbreviation\\\": \\\"DC\\\"\\n},\\n{\\n\\\"name\\\": \\\"Federated States Of Micronesia\\\",\\n\\\"abbreviation\\\": \\\"FM\\\"\\n},\\n{\\n\\\"name\\\": \\\"Florida\\\",\\n\\\"abbreviation\\\": \\\"FL\\\"\\n},\\n{\\n\\\"name\\\": \\\"Georgia\\\",\\n\\\"abbreviation\\\": \\\"GA\\\"\\n},\\n{\\n\\\"name\\\": \\\"Guam\\\",\\n\\\"abbreviation\\\": \\\"GU\\\"\\n},\\n{\\n\\\"name\\\": \\\"Hawaii\\\",\\n\\\"abbreviation\\\": \\\"HI\\\"\\n},\\n{\\n\\\"name\\\": \\\"Idaho\\\",\\n\\\"abbreviation\\\": \\\"ID\\\"\\n},\\n{\\n\\\"name\\\": \\\"Illinois\\\",\\n\\\"abbreviation\\\": \\\"IL\\\"\\n},\\n{\\n\\\"name\\\": \\\"Illinois – Chicago\\\",\\n\\\"abbreviation\\\": \\\"Chicago\\\"\\n},\\n{\\n\\\"name\\\": \\\"Indiana\\\",\\n\\\"abbreviation\\\": \\\"IN\\\"\\n},\\n{\\n\\\"name\\\": \\\"Iowa\\\",\\n\\\"abbreviation\\\": \\\"IA\\\"\\n},\\n{\\n\\\"name\\\": \\\"Kansas\\\",\\n\\\"abbreviation\\\": \\\"KS\\\"\\n},\\n{\\n\\\"name\\\": \\\"Kentucky\\\",\\n\\\"abbreviation\\\": \\\"KY\\\"\\n},\\n{\\n\\\"name\\\": \\\"Louisiana\\\",\\n\\\"abbreviation\\\": \\\"LA\\\"\\n},\\n{\\n\\\"name\\\": \\\"Maine\\\",\\n\\\"abbreviation\\\": \\\"ME\\\"\\n},\\n{\\n\\\"name\\\": \\\"Marshall Islands\\\",\\n\\\"abbreviation\\\": \\\"MH\\\"\\n},\\n{\\n\\\"name\\\": \\\"Maryland\\\",\\n\\\"abbreviation\\\": \\\"MD\\\"\\n},\\n{\\n\\\"name\\\": \\\"Massachusetts\\\",\\n\\\"abbreviation\\\": \\\"MA\\\"\\n},\\n{\\n\\\"name\\\": \\\"Michigan\\\",\\n\\\"abbreviation\\\": \\\"MI\\\"\\n},\\n{\\n\\\"name\\\": \\\"Minnesota\\\",\\n\\\"abbreviation\\\": \\\"MN\\\"\\n},\\n{\\n\\\"name\\\": \\\"Mississippi\\\",\\n\\\"abbreviation\\\": \\\"MS\\\"\\n},\\n{\\n\\\"name\\\": \\\"Missouri\\\",\\n\\\"abbreviation\\\": \\\"MO\\\"\\n},\\n{\\n\\\"name\\\": \\\"Montana\\\",\\n\\\"abbreviation\\\": \\\"MT\\\"\\n},\\n{\\n\\\"name\\\": \\\"Nebraska\\\",\\n\\\"abbreviation\\\": \\\"NE\\\"\\n},\\n{\\n\\\"name\\\": \\\"Nevada\\\",\\n\\\"abbreviation\\\": \\\"NV\\\"\\n},\\n{\\n\\\"name\\\": \\\"New Hampshire\\\",\\n\\\"abbreviation\\\": \\\"NH\\\"\\n},\\n{\\n\\\"name\\\": \\\"New Jersey\\\",\\n\\\"abbreviation\\\": \\\"NJ\\\"\\n},\\n{\\n\\\"name\\\": \\\"New Mexico\\\",\\n\\\"abbreviation\\\": \\\"NM\\\"\\n},\\n{\\n\\\"name\\\": \\\"New York\\\",\\n\\\"abbreviation\\\": \\\"NY\\\"\\n},\\n{\\n\\\"name\\\": \\\"New York – New York City\\\",\\n\\\"abbreviation\\\": \\\"New_York_City\\\"\\n},\\n{\\n\\\"name\\\": \\\"North Carolina\\\",\\n\\\"abbreviation\\\": \\\"NC\\\"\\n},\\n{\\n\\\"name\\\": \\\"North Dakota\\\",\\n\\\"abbreviation\\\": \\\"ND\\\"\\n},\\n{\\n\\\"name\\\": \\\"Northern Mariana Islands\\\",\\n\\\"abbreviation\\\": \\\"MP\\\"\\n},\\n{\\n\\\"name\\\": \\\"Ohio\\\",\\n\\\"abbreviation\\\": \\\"OH\\\"\\n},\\n{\\n\\\"name\\\": \\\"Oklahoma\\\",\\n\\\"abbreviation\\\": \\\"OK\\\"\\n},\\n{\\n\\\"name\\\": \\\"Oregon\\\",\\n\\\"abbreviation\\\": \\\"OR\\\"\\n},\\n{\\n\\\"name\\\": \\\"Palau\\\",\\n\\\"abbreviation\\\": \\\"PW\\\"\\n},\\n{\\n\\\"name\\\": \\\"Pennsylvania\\\",\\n\\\"abbreviation\\\": \\\"PA\\\"\\n},\\n{\\n\\\"name\\\": \\\"Puerto Rico\\\",\\n\\\"abbreviation\\\": \\\"PR\\\"\\n},\\n{\\n\\\"name\\\": \\\"Rhode Island\\\",\\n\\\"abbreviation\\\": \\\"RI\\\"\\n},\\n{\\n\\\"name\\\": \\\"South Carolina\\\",\\n\\\"abbreviation\\\": \\\"SC\\\"\\n},\\n{\\n\\\"name\\\": \\\"South Dakota\\\",\\n\\\"abbreviation\\\": \\\"SD\\\"\\n},\\n{\\n\\\"name\\\": \\\"Tennessee\\\",\\n\\\"abbreviation\\\": \\\"TN\\\"\\n},\\n{\\n\\\"name\\\": \\\"Texas\\\",\\n\\\"abbreviation\\\": \\\"TX\\\"\\n},\\n{\\n\\\"name\\\": \\\"Utah\\\",\\n\\\"abbreviation\\\": \\\"UT\\\"\\n},\\n{\\n\\\"name\\\": \\\"Vermont\\\",\\n\\\"abbreviation\\\": \\\"VT\\\"\\n},\\n{\\n\\\"name\\\": \\\"Virgin Islands\\\",\\n\\\"abbreviation\\\": \\\"VI\\\"\\n},\\n{\\n\\\"name\\\": \\\"Virginia\\\",\\n\\\"abbreviation\\\": \\\"VA\\\"\\n},\\n{\\n\\\"name\\\": \\\"Washington\\\",\\n\\\"abbreviation\\\": \\\"WA\\\"\\n},\\n{\\n\\\"name\\\": \\\"West Virginia\\\",\\n\\\"abbreviation\\\": \\\"WV\\\"\\n},\\n{\\n\\\"name\\\": \\\"Wisconsin\\\",\\n\\\"abbreviation\\\": \\\"WI\\\"\\n},\\n{\\n\\\"name\\\": \\\"Wyoming\\\",\\n\\\"abbreviation\\\": \\\"WY\\\"\\n}\\n].map(item => ({title:item.name , value:item.abbreviation }))\"},{\"id\":\"224153b58448-b195774208951118-e858\",\"type\":\"datasource\",\"designer\":{\"xLocation\":347,\"yLocation\":353,\"next\":\"7a0b0ee7f2cc-e9627e1f52688157-fef5\",\"errorStepId\":\"3380458372a2-afe5ae1027557fae-6e1f\"},\"dataConnection\":\"\",\"urlBase\":\"'https://graph.microsoft.com/v1.0/teams/'+ scenario.ShiftsTeamID +'/schedule/openShifts'\",\"urlPath\":\"\",\"urlParams\":\"'$filter=sharedOpenShift/startDateTime ge ' + scenario.startdate + ' and sharedOpenShift/endDateTime le '+scenario.enddate\",\"method\":\"get\",\"headers\":\"{\\r\\n    \\\"Authorization\\\" : \\\"Bearer \\\" + scenario.bearerToken.access_token\\r\\n}\",\"opJson\":true,\"opResolveWithFullResponse\":false,\"label\":\"ListOpenShiftsForSelectedDate\",\"response\":\"getOpenShifts\",\"error\":\"getOpenShiftsError\"},{\"id\":\"515ea0237e93-5a86404fb9b00623-1884\",\"type\":\"action\",\"label\":\"Action\",\"designer\":{\"xLocation\":350,\"yLocation\":260,\"next\":\"224153b58448-b195774208951118-e858\"},\"onInit\":\"scenario.startdate = moment(scenario.date.preferredDate).format(\\\"YYYY-MM-DDTHH:mm\\\") +'Z';\\r\\nscenario.enddate = moment(scenario.date.preferredDate).add(1,'days').format(\\\"YYYY-MM-DDTHH:mm\\\")+'Z';\\r\\nscenario.OpenShiftFilter = 'sharedOpenShift/startDateTime ge ' + scenario.startdate + ' and sharedOpenShift/endDateTime le '+scenario.enddate;\"},{\"id\":\"0bb408e737f1-f7e57a7491f19b1c-97a3\",\"type\":\"action\",\"label\":\"Action\",\"designer\":{\"xLocation\":460,\"yLocation\":520,\"next\":\"d496f6015adb-859abf2071bb4240-7e1b\"},\"onInit\":\"var _ = require('underscore');\\r\\n \\r\\n_.each(scenario.getOpenShifts.value, function(value){\\r\\n    if(value.sharedOpenShift.openSlotCount == 0 ) {\\r\\n        scenario.allSlots = _.without(scenario.allSlots,moment(value.sharedOpenShift.startDateTime).subtract(6, 'hours').format('h:mm A'));\\r\\n    }\\r\\n    \\r\\n});\\r\\nscenario.allSlots = scenario.allSlots.map(item => ({title:item , value:item }));\\r\\n\"},{\"id\":\"99347383af17-b4d6ad15a6baa959-482e\",\"type\":\"branch\",\"condition\":\"scenario.isAppointmentTimeAvailable\",\"designer\":{\"xLocation\":354,\"yLocation\":520,\"next\":\"e0db74b68bc0-1618c40aa2ca1854-0e69\"},\"targetStepId\":\"0bb408e737f1-f7e57a7491f19b1c-97a3\"},{\"id\":\"d496f6015adb-859abf2071bb4240-7e1b\",\"type\":\"prompt\",\"dataType\":\"object\",\"designer\":{\"xLocation\":451,\"yLocation\":600,\"next\":\"96c5099fe6df-4503742d69f7b04d-0967\"},\"variable\":\"preferredTime\",\"submitTitle\":\"Submit\",\"stringId\":\"stringId_edccbbab65c42b11\",\"label\":\"SlotSelect\",\"layout\":\"vertical\",\"attachment\":[{\"type\":\"AdaptiveCard\",\"cardCode\":\"{\\r\\n    \\\"type\\\": \\\"AdaptiveCard\\\",\\r\\n    \\\"$schema\\\": \\\"http://adaptivecards.io/schemas/adaptive-card.json\\\",\\r\\n    \\\"version\\\": \\\"1.2\\\",\\r\\n    \\\"body\\\": [\\r\\n        {\\r\\n            \\\"type\\\": \\\"TextBlock\\\",\\r\\n            \\\"text\\\": \\\"Please choose your preferred time slot.\\\",\\r\\n            \\\"wrap\\\": true\\r\\n        },\\r\\n        {\\r\\n            \\\"type\\\": \\\"Input.ChoiceSet\\\",\\r\\n            \\\"id\\\": \\\"availSlots\\\",\\r\\n            \\\"placeholder\\\": \\\"Please choose your preferred time slot\\\",\\r\\n            \\\"style\\\": \\\"compact\\\",\\r\\n            \\\"isRequired\\\": true,                         //does not work in v1.2\\r\\n            \\\"errorMessage\\\": \\\"This is a required input\\\", //does not work in v1.2\\r\\n            \\\"choices\\\": scenario.allSlots\\r\\n        }\\r\\n    ],\\r\\n    \\\"actions\\\": [\\r\\n        {\\r\\n            \\\"type\\\": \\\"Action.Submit\\\",\\r\\n            \\\"title\\\": \\\"Next\\\"\\r\\n        }\\r\\n    ]\\r\\n}\"}]},{\"id\":\"96c5099fe6df-4503742d69f7b04d-0967\",\"type\":\"action\",\"label\":\"Action\",\"designer\":{\"xLocation\":454,\"yLocation\":660,\"next\":\"2fbeb02da317-516f83805d80fccb-db41\"},\"onInit\":\"var _ = require('underscore');\\r\\nscenario.selectedDateTime = moment(scenario.date.preferredDate+\\\" \\\"+scenario.preferredTime.availSlots).add(6,'hours').format(\\\"YYYY-MM-DDTHH:mm:ss\\\") +'Z';\\r\\nscenario.shiftStartDateTime = moment(scenario.date.preferredDate+\\\" \\\"+scenario.preferredTime.availSlots).add(6,'hours').format(\\\"YYYY-MM-DDTHH:mm:ss\\\") +'Z';\\r\\nscenario.shiftEndDateTime = moment(scenario.date.preferredDate+\\\" \\\"+scenario.preferredTime.availSlots).add(6,'hours').add(20,'minutes').format(\\\"YYYY-MM-DDTHH:mm:ss\\\") +'Z';\\r\\n_.each(scenario.getOpenShifts.value, function(value){\\r\\n    if(value.sharedOpenShift.openSlotCount > 0 && scenario.selectedDateTime == value.sharedOpenShift.startDateTime) {\\r\\n        value.sharedOpenShift.openSlotCount = value.sharedOpenShift.openSlotCount - 1;\\r\\n        return scenario.selectedOpenShift = value;\\r\\n    }\\r\\n        \\r\\n});\\r\\n\"},{\"id\":\"2fbeb02da317-516f83805d80fccb-db41\",\"type\":\"datasource\",\"designer\":{\"xLocation\":760,\"yLocation\":80,\"next\":\"ff68459bbe1c-daa05148edc8e1e0-6dee\",\"errorStepId\":\"db630ecba620-1812d825e93b655f-1092\"},\"dataConnection\":\"\",\"urlBase\":\"'https://graph.microsoft.com/v1.0/teams/'+ scenario.ShiftsTeamID +'/schedule/openShifts/'+scenario.selectedOpenShift.id\",\"urlPath\":\"\",\"urlParams\":\"\",\"method\":\"put\",\"headers\":\"{\\r\\n    \\\"Authorization\\\" : \\\"Bearer \\\" + scenario.bearerToken.access_token\\r\\n}\",\"opJson\":true,\"opResolveWithFullResponse\":false,\"label\":\"UpdateOpenShiftById\",\"response\":\"putOpenShifts\",\"error\":\"putOpenShiftsError\",\"contentType\":\"raw\",\"payload\":\"scenario.selectedOpenShift\"},{\"id\":\"ff68459bbe1c-daa05148edc8e1e0-6dee\",\"type\":\"datasource\",\"designer\":{\"xLocation\":760,\"yLocation\":160,\"next\":\"2942a61096ee-f8f26440e83de2cb-603b\",\"errorStepId\":\"c4a8dadd3076-8bc2942f90550bfa-3ab7\"},\"dataConnection\":\"\",\"urlBase\":\"'https://graph.microsoft.com/v1.0/teams/'+ scenario.ShiftsTeamID +'/schedule/shifts'\",\"urlPath\":\"\",\"urlParams\":\"'$filter=sharedShift/startDateTime ge ' + scenario.shiftStartDateTime + ' and sharedShift/endDateTime le '+scenario.shiftEndDateTime\",\"method\":\"get\",\"headers\":\"{\\r\\n    \\\"Authorization\\\" : \\\"Bearer \\\" + scenario.bearerToken.access_token\\r\\n}\",\"opJson\":true,\"opResolveWithFullResponse\":false,\"label\":\"ListShiftsForSelectedDate\",\"response\":\"getShifts\",\"error\":\"getShiftsError\"},{\"id\":\"2942a61096ee-f8f26440e83de2cb-603b\",\"type\":\"action\",\"label\":\"Action\",\"designer\":{\"xLocation\":760,\"yLocation\":260,\"next\":\"836a9973652b-2f6fae18fbad8b80-30fe\"},\"onInit\":\"var _ = require('underscore');\\r\\n\\r\\nvar userIds = scenario.getSchedulingGroup.userIds;\\r\\n_.each(scenario.getShifts.value, function(value){\\r\\n    userIds = _.without(userIds,value.userId);\\r\\n});\\r\\nscenario.userIdToAssign = userIds[0];\\r\\n\\r\\nscenario.startdate2 = moment(scenario.date.preferredDate).add(21,'days').format(\\\"MM-DD-YYYY\\\");\\r\\nscenario.startdate2a = moment(scenario.date.preferredDate).add(21,'days').format(\\\"YYYY-MM-DD\\\");\\r\\n//scenario.startdateForSecondAppointment = moment(scenario.date.preferredDate).add(21,'days').format(\\\"YYYY-MM-DDTHH:mm\\\") +'Z';\\r\\n//scenario.enddateForSecondAppointment = moment(scenario.date.preferredDate).add(22,'days').format(\\\"YYYY-MM-DDTHH:mm\\\")+'Z';\\r\\n//scenario.OpenShiftFilterForSecondAppointment = 'sharedOpenShift/startDateTime ge ' + scenario.startdateForSecondAppointment + ' and sharedOpenShift/endDateTime le '+scenario.enddateForSecondAppointment;\\r\\n\\r\\n\"},{\"id\":\"836a9973652b-2f6fae18fbad8b80-30fe\",\"type\":\"datasource\",\"designer\":{\"xLocation\":760,\"yLocation\":353,\"next\":\"0af5628b1e08-77ee249e4cca7c8f-58ab\",\"errorStepId\":\"ad3cbc60f8c2-770728a8fa99d047-b7d0\"},\"dataConnection\":\"\",\"urlBase\":\"'https://graph.microsoft.com/v1.0/teams/'+ scenario.ShiftsTeamID +'/schedule/shifts'\",\"urlPath\":\"\",\"urlParams\":\"\",\"method\":\"post\",\"headers\":\"{\\r\\n    \\\"Authorization\\\" : \\\"Bearer \\\" + scenario.bearerToken.access_token\\r\\n}\",\"opJson\":true,\"opResolveWithFullResponse\":false,\"label\":\"CreateShift\",\"response\":\"getCreateShifts\",\"error\":\"getCreateShiftsError\",\"contentType\":\"raw\",\"payload\":\"{\\r\\n    \\\"schedulingGroupId\\\": scenario.getSchedulingGroup.id,\\r\\n    \\\"userId\\\": scenario.userIdToAssign,\\r\\n    \\\"draftShift\\\": null,        \\r\\n    \\\"sharedShift\\\": {\\r\\n        \\\"displayName\\\": \\\"\\\",\\r\\n        \\\"notes\\\": scenario.bookingInfo,\\r\\n        \\\"startDateTime\\\": scenario.shiftStartDateTime,\\r\\n        \\\"endDateTime\\\": scenario.shiftEndDateTime,\\r\\n        \\\"theme\\\": \\\"blue\\\",\\r\\n        \\\"activities\\\": []\\r\\n    }\\r\\n}\"},{\"id\":\"e0db74b68bc0-1618c40aa2ca1854-0e69\",\"type\":\"statement\",\"designer\":{\"xLocation\":220,\"yLocation\":600},\"text\":\"We're sorry, but we were unable to find any appointment slots available at this time, please check back later.\",\"stringId\":\"stringId_f90615e2fcf4a198\"},{\"id\":\"bcd697fe8d0b-26042c0ea1cd5977-e9c3\",\"type\":\"prompt\",\"dataType\":\"object\",\"designer\":{\"xLocation\":1220,\"yLocation\":614,\"next\":\"8d143c7dc629-392693b11bc3c6fe-48a5\"},\"variable\":\"preferredTimeForSecondAppointment\",\"submitTitle\":\"Submit\",\"stringId\":\"stringId_edccbbab65c42b11\",\"label\":\"SlotSelect\",\"layout\":\"vertical\",\"attachment\":[{\"type\":\"AdaptiveCard\",\"cardCode\":\"{\\r\\n    \\\"type\\\": \\\"AdaptiveCard\\\",\\r\\n    \\\"$schema\\\": \\\"http://adaptivecards.io/schemas/adaptive-card.json\\\",\\r\\n    \\\"version\\\": \\\"1.2\\\",\\r\\n    \\\"body\\\": [\\r\\n        {\\r\\n            \\\"type\\\": \\\"TextBlock\\\",\\r\\n            \\\"text\\\": \\\"Please choose your preferred time slot.\\\",\\r\\n            \\\"wrap\\\": true\\r\\n        },\\r\\n        {\\r\\n            \\\"type\\\": \\\"Input.ChoiceSet\\\",\\r\\n            \\\"id\\\": \\\"availSlots\\\",\\r\\n            \\\"placeholder\\\": \\\"Please choose your preferred time slot\\\",\\r\\n            \\\"style\\\": \\\"compact\\\",\\r\\n            \\\"isRequired\\\": true,                         //does not work in v1.2\\r\\n            \\\"errorMessage\\\": \\\"This is a required input\\\", //does not work in v1.2\\r\\n            \\\"choices\\\": scenario.allSlots\\r\\n        }\\r\\n    ],\\r\\n    \\\"actions\\\": [\\r\\n        {\\r\\n            \\\"type\\\": \\\"Action.Submit\\\",\\r\\n            \\\"title\\\": \\\"Next\\\"\\r\\n        }\\r\\n    ]\\r\\n}\"}]},{\"id\":\"8d143c7dc629-392693b11bc3c6fe-48a5\",\"type\":\"action\",\"label\":\"Action\",\"designer\":{\"xLocation\":1220,\"yLocation\":687,\"next\":\"e8bf0e465c13-ba7458250d006dc6-8874\"},\"onInit\":\"var _ = require('underscore');\\r\\n\\r\\nvar secondAppointmentDate = moment(scenario.secondDate.preferredDate).format(\\\"YYYY-MM-DD\\\");\\r\\nscenario.shiftStartDateTimeForSecondAppointment = moment(secondAppointmentDate+\\\" \\\"+scenario.preferredTimeForSecondAppointment.availSlots).add(6,'hours').format(\\\"YYYY-MM-DDTHH:mm:ss\\\") +'Z';\\r\\nscenario.shiftEndDateTimeForSecondAppointment = moment(secondAppointmentDate+\\\" \\\"+scenario.preferredTimeForSecondAppointment.availSlots).add(6,'hours').add(20,'minutes').format(\\\"YYYY-MM-DDTHH:mm:ss\\\") +'Z';\\r\\n_.each(scenario.getOpenShiftsForSecondAppointment.value, function(value){\\r\\n    if(value.sharedOpenShift.openSlotCount > 0 && scenario.shiftStartDateTimeForSecondAppointment == value.sharedOpenShift.startDateTime) {\\r\\n        value.sharedOpenShift.openSlotCount = value.sharedOpenShift.openSlotCount - 1;\\r\\n        return scenario.selectedOpenShiftForSecondAppointment = value;\\r\\n    }\\r\\n        \\r\\n});\\r\\n\"},{\"id\":\"e8bf0e465c13-ba7458250d006dc6-8874\",\"type\":\"datasource\",\"designer\":{\"xLocation\":1370,\"yLocation\":240,\"next\":\"508318bad434-aa123285589ff5e7-6cc2\",\"errorStepId\":\"d3cb3d233cc5-822f28c59d762e6d-afdb\"},\"dataConnection\":\"\",\"urlBase\":\"'https://graph.microsoft.com/v1.0/teams/'+ scenario.ShiftsTeamID +'/schedule/openShifts/'+scenario.selectedOpenShiftForSecondAppointment.id\",\"urlPath\":\"\",\"urlParams\":\"\",\"method\":\"put\",\"headers\":\"{\\r\\n    \\\"Authorization\\\" : \\\"Bearer \\\" + scenario.bearerToken.access_token\\r\\n}\",\"opJson\":true,\"opResolveWithFullResponse\":false,\"label\":\"UpdateOpenShiftForSecondAppointmentById\",\"response\":\"putOpenShiftsForSecondAppointment\",\"error\":\"putOpenShiftsForSecondAppointmentError\",\"contentType\":\"raw\",\"payload\":\"scenario.selectedOpenShiftForSecondAppointment\"},{\"id\":\"508318bad434-aa123285589ff5e7-6cc2\",\"type\":\"datasource\",\"designer\":{\"xLocation\":1380,\"yLocation\":312,\"next\":\"1842fd53a64a-b013492130bafd7e-cfea\",\"errorStepId\":\"0b6f11c5a31a-8d09a23d32a62c94-31d1\"},\"dataConnection\":\"\",\"urlBase\":\"'https://graph.microsoft.com/v1.0/teams/'+ scenario.ShiftsTeamID +'/schedule/shifts'\",\"urlPath\":\"\",\"urlParams\":\"'$filter=sharedShift/startDateTime ge ' + scenario.shiftStartDateTimeForSecondAppointment + ' and sharedShift/endDateTime le '+scenario.shiftEndDateTimeForSecondAppointment\",\"method\":\"get\",\"headers\":\"{\\r\\n    \\\"Authorization\\\" : \\\"Bearer \\\" + scenario.bearerToken.access_token\\r\\n}\",\"opJson\":true,\"opResolveWithFullResponse\":false,\"label\":\"ListShiftsForSecondAppointmentForSelectedDateTime\",\"response\":\"getShiftsForSecondAppointment\",\"error\":\"getShiftsForSecondAppointmentError\"},{\"id\":\"1842fd53a64a-b013492130bafd7e-cfea\",\"type\":\"action\",\"label\":\"Action\",\"designer\":{\"xLocation\":1391,\"yLocation\":380,\"next\":\"c5d8ea37cbef-8ae33c6436260755-f63d\"},\"onInit\":\"var _ = require('underscore');\\r\\n\\r\\nvar userIds = scenario.getSchedulingGroup.userIds;\\r\\n_.each(scenario.getShiftsForSecondAppointment.value, function(value){\\r\\n    userIds = _.without(userIds,value.userId);\\r\\n});\\r\\nscenario.userIdToAssignForSecondAppointment = userIds[0];\\r\\n\\r\\n\\r\\n\"},{\"id\":\"c5d8ea37cbef-8ae33c6436260755-f63d\",\"type\":\"datasource\",\"designer\":{\"xLocation\":1390,\"yLocation\":460,\"errorStepId\":\"bb8ddb6a4bda-d82c15bb38e27b7f-9f4e\",\"next\":\"aaedff36ddf1-c111071847542181-fbd7\"},\"dataConnection\":\"\",\"urlBase\":\"'https://graph.microsoft.com/v1.0/teams/'+ scenario.ShiftsTeamID +'/schedule/shifts'\",\"urlPath\":\"\",\"urlParams\":\"\",\"method\":\"post\",\"headers\":\"{\\r\\n    \\\"Authorization\\\" : \\\"Bearer \\\" + scenario.bearerToken.access_token\\r\\n}\",\"opJson\":true,\"opResolveWithFullResponse\":false,\"label\":\"CreateShiftForSecondAppointment\",\"response\":\"getCreateShiftsForSecondAppointment\",\"error\":\"getCreateShiftsForSecondAppointmentError\",\"contentType\":\"raw\",\"payload\":\"{\\r\\n    \\\"schedulingGroupId\\\": scenario.getSchedulingGroup.id,\\r\\n    \\\"userId\\\": scenario.userIdToAssignForSecondAppointment,\\r\\n    \\\"draftShift\\\": null,        \\r\\n    \\\"sharedShift\\\": {\\r\\n        \\\"displayName\\\": \\\"\\\",\\r\\n        \\\"notes\\\": scenario.bookingInfo,\\r\\n        \\\"startDateTime\\\": scenario.shiftStartDateTimeForSecondAppointment,\\r\\n        \\\"endDateTime\\\": scenario.shiftEndDateTimeForSecondAppointment,\\r\\n        \\\"theme\\\": \\\"blue\\\",\\r\\n        \\\"activities\\\": []\\r\\n    }\\r\\n}\"},{\"id\":\"0af5628b1e08-77ee249e4cca7c8f-58ab\",\"type\":\"prompt\",\"dataType\":\"object\",\"designer\":{\"xLocation\":760,\"yLocation\":440,\"next\":\"ec9cf39d8d78-343c8e45e99f5d6e-d529\"},\"variable\":\"secondDate\",\"submitTitle\":\"Submit\",\"stringId\":\"stringId_819c792e2e8fa121\",\"layout\":\"vertical\",\"attachment\":[{\"type\":\"AdaptiveCard\",\"cardCode\":\"{\\r\\n    \\\"type\\\": \\\"AdaptiveCard\\\",\\r\\n    \\\"$schema\\\": \\\"http://adaptivecards.io/schemas/adaptive-card.json\\\",\\r\\n    \\\"version\\\": \\\"1.2\\\",\\r\\n    \\\"body\\\": [\\r\\n        {\\r\\n            \\\"type\\\": \\\"TextBlock\\\",\\r\\n            \\\"text\\\": \\\"Please select a date for your second vaccination.\\\",\\r\\n            \\\"wrap\\\": true\\r\\n        },\\r\\n        {\\r\\n            \\\"type\\\": \\\"Input.Date\\\",\\r\\n            \\\"id\\\": \\\"preferredDate\\\",\\r\\n            \\\"value\\\" : scenario.startdate2a,\\r\\n            \\\"min\\\" : scenario.startdate2a\\r\\n        },\\r\\n        {\\r\\n            \\\"type\\\": \\\"ActionSet\\\",\\r\\n            \\\"actions\\\": [\\r\\n                {\\r\\n                    \\\"type\\\": \\\"Action.Submit\\\",\\r\\n                    \\\"title\\\": \\\"Next\\\"\\r\\n                }\\r\\n            ]\\r\\n        }\\r\\n    ]\\r\\n}\"}],\"label\":\"DatePicker\"},{\"id\":\"c5123f8583b6-1c3b79f5fc9ee953-7adc\",\"type\":\"datasource\",\"designer\":{\"xLocation\":1040,\"yLocation\":350,\"next\":\"7407070a4fe1-8e6d0d83fd2cfa43-b5c0\",\"errorStepId\":\"56f52fb50ba7-b3833c49356c6a20-4251\"},\"dataConnection\":\"\",\"urlBase\":\"'https://graph.microsoft.com/v1.0/teams/'+ scenario.ShiftsTeamID +'/schedule/openShifts'\",\"urlPath\":\"\",\"urlParams\":\"'$filter=sharedOpenShift/startDateTime ge ' + scenario.startdateForSecondAppointment + ' and sharedOpenShift/endDateTime le '+scenario.enddateForSecondAppointment\",\"method\":\"get\",\"headers\":\"{\\r\\n    \\\"Authorization\\\" : \\\"Bearer \\\" + scenario.bearerToken.access_token\\r\\n}\",\"opJson\":true,\"opResolveWithFullResponse\":false,\"label\":\"ListOpenShiftsForSelectedDate\",\"response\":\"getOpenShiftsForSecondAppointment\",\"error\":\"getOpenShiftsForSecondAppointmentError\"},{\"id\":\"ec9cf39d8d78-343c8e45e99f5d6e-d529\",\"type\":\"action\",\"label\":\"Action\",\"designer\":{\"xLocation\":1050,\"yLocation\":260,\"next\":\"c5123f8583b6-1c3b79f5fc9ee953-7adc\"},\"onInit\":\"scenario.startdateForSecondAppointment = moment(scenario.secondDate.preferredDate).format(\\\"YYYY-MM-DDTHH:mm\\\") +'Z';\\r\\nscenario.enddateForSecondAppointment = moment(scenario.secondDate.preferredDate).add(1,'days').format(\\\"YYYY-MM-DDTHH:mm\\\")+'Z';\\r\\n//scenario.OpenShiftFilterForSecondAppointment = 'sharedOpenShift/startDateTime ge ' + scenario.startdateForSecondAppointment + ' and sharedOpenShift/endDateTime le '+scenario.enddateForSecondAppointment;\\r\\nscenario.allSlots = scenario.masterSlots;\"},{\"id\":\"7407070a4fe1-8e6d0d83fd2cfa43-b5c0\",\"type\":\"action\",\"label\":\"Action\",\"designer\":{\"xLocation\":1052,\"yLocation\":440,\"next\":\"381865f396cc-59e72658dce30075-97ef\"},\"onInit\":\"var _ = require('underscore');\\r\\nvar count = 0;\\r\\nscenario.isAppointmentTimeAvailable = false;\\r\\n_.each(scenario.getOpenShiftsForSecondAppointment.value, function(value){\\r\\n    if(value.sharedOpenShift.openSlotCount > 0 )\\r\\n        count++;\\r\\n    if(count > 0) {\\r\\n        scenario.isAppointmentTimeAvailable = true;\\r\\n        return count;\\r\\n    }\\r\\n        \\r\\n});\\r\\n\\r\\n\\r\\n\"},{\"id\":\"381865f396cc-59e72658dce30075-97ef\",\"type\":\"branch\",\"condition\":\"scenario.isAppointmentTimeAvailable\",\"designer\":{\"xLocation\":1050,\"yLocation\":534,\"next\":\"d78fd1ae0cc8-9b4fc3b5fadee110-5f37\"},\"targetStepId\":\"9de7cef6d70b-ea4ede618cf5d231-4e9c\"},{\"id\":\"d78fd1ae0cc8-9b4fc3b5fadee110-5f37\",\"type\":\"statement\",\"designer\":{\"xLocation\":930,\"yLocation\":600},\"text\":\"We're sorry, but we were unable to find any appointment slots available at this time, please check back later.\",\"stringId\":\"stringId_f90615e2fcf4a198\"},{\"id\":\"9de7cef6d70b-ea4ede618cf5d231-4e9c\",\"type\":\"action\",\"label\":\"Action\",\"designer\":{\"xLocation\":1220,\"yLocation\":527,\"next\":\"bcd697fe8d0b-26042c0ea1cd5977-e9c3\"},\"onInit\":\"var _ = require('underscore');\\r\\n\\r\\n_.each(scenario.getOpenShiftsForSecondAppointment.value, function(value){\\r\\n    if(value.sharedOpenShift.openSlotCount == 0 )\\r\\n        scenario.allSlots = _.without(scenario.allSlots,moment(value.sharedOpenShift.startDateTime).subtract(6, 'hours').format('h:mm A'));\\r\\n});\\r\\nscenario.allSlots = scenario.allSlots.map(item => ({title:item , value:item }));\\r\\n\"},{\"id\":\"db630ecba620-1812d825e93b655f-1092\",\"type\":\"statement\",\"designer\":{\"xLocation\":628,\"yLocation\":100},\"text\":\"I'm so embarrassed, but for whatever reason, I couldn't connect to the API.  Please contact my creator and let him know that I failed to update open shift ID.\",\"stringId\":\"stringId_9c34d3d1b918eaa5\"},{\"id\":\"aaedff36ddf1-c111071847542181-fbd7\",\"type\":\"statement\",\"designer\":{\"xLocation\":1387,\"yLocation\":540},\"text\":\"Thank you for scheduling your appointments.\",\"stringId\":\"stringId_03f79576cd81567a\"},{\"id\":\"1101b3f744b7-36289860c988f8a3-4bc8\",\"type\":\"action\",\"label\":\"Manual\",\"designer\":{\"xLocation\":48,\"yLocation\":133,\"next\":\"2212a4688881-d1d71aef13d1598e-9816\"},\"onInit\":\"scenario.scope = getEnv(\\\"scope\\\");\\nscenario.clientid = getEnv(\\\"shiftsClientID\\\"); // From App Registration\\nscenario.clientsecret = getEnv(\\\"shiftsClientSecret\\\"); // From App Registration\\nscenario.username = getEnv(\\\"shiftsUsername\\\"); // Admin Account with Access to the Shift Schedule\\nscenario.password = getEnv(\\\"shiftsPassword\\\");    \\nscenario.granttype = 'password';\\nscenario.ShiftGroupID = getEnv(\\\"shiftsGroupID\\\");\\nscenario.ShiftsTeamID = getEnv(\\\"shiftsTeamID\\\");\\nscenario.TenantID = getEnv(\\\"tenantID\\\");\\n\\nscenario.minDateForFirstAppointment = moment().add(1,'days').format(\\\"YYYY-MM-DD\\\");\\n\\nscenario.manualExec = 'Y';\\nscenario.lat        = 47.673988;\\nscenario.lng        = -122.121513;\\nscenario.phase      = '1a';\\nscenario.usePostal  = 'N';\\nscenario.postal     = '54449';\\nscenario.FirstName  = 'gg'\\nscenario.LastName   = 'gg';\\nscenario.DOB        = '1961-01-01';\\nscenario.Email      = 'gg@gg.com';\\nscenario.Phone      = '555-155-5555';\\nscenario.Street1    = '';\\nscenario.Street2    = '';\\nscenario.City       = '';\\nscenario.State      = 'AL';\\n\\nscenario.bookingInfo = scenario.FirstName + ' ' + scenario.LastName + ' DOB: ' + scenario.DOB;\\n\\n\\nscenario.masterSlots = [\\n\\\"8:00 AM\\\",\\n\\\"8:20 AM\\\",\\n\\\"8:40 AM\\\",\\n\\\"9:00 AM\\\",\\n\\\"9:20 AM\\\",\\n\\\"9:40 AM\\\",\\n\\\"10:00 AM\\\",\\n\\\"10:20 AM\\\",\\n\\\"10:40 AM\\\",\\n\\\"11:00 AM\\\",\\n\\\"11:20 AM\\\",\\n\\\"11:40 AM\\\",\\n\\\"12:00 AM\\\",\\n\\\"12:20 PM\\\",\\n\\\"12:40 PM\\\",\\n\\\"1:00 PM\\\",\\n\\\"1:20 PM\\\",\\n\\\"1:40 PM\\\",\\n\\\"2:00 PM\\\",\\n\\\"2:20 PM\\\",\\n\\\"2:40 PM\\\",\\n\\\"3:00 PM\\\",\\n\\\"3:20 PM\\\",\\n\\\"3:40 PM\\\",\\n\\\"4:00 PM\\\",\\n\\\"4:20 PM\\\",\\n\\\"4:40 PM\\\",\\n\\\"5:00 PM\\\",\\n];\\n\\nscenario.allSlots = scenario.masterSlots;\"},{\"id\":\"c5f86e9d10b7-f553189227aa2776-1626\",\"type\":\"statement\",\"designer\":{\"xLocation\":213,\"yLocation\":189},\"text\":\"I'm so embarrassed, but for whatever reason, I couldn't connect to the API.  Please contact my creator and tell him that I failed to get Schedule Group ID.\",\"stringId\":\"stringId_9c34d3d1b918eaa5\"},{\"id\":\"3380458372a2-afe5ae1027557fae-6e1f\",\"type\":\"statement\",\"designer\":{\"xLocation\":208,\"yLocation\":367},\"text\":\"I'm so embarrassed, but for whatever reason, I couldn't connect to the API.  Please contact my creator that I failed to get open shifts list.\",\"stringId\":\"stringId_9c34d3d1b918eaa5\"},{\"id\":\"c4a8dadd3076-8bc2942f90550bfa-3ab7\",\"type\":\"statement\",\"designer\":{\"xLocation\":628,\"yLocation\":190},\"text\":\"I'm so embarrassed, but for whatever reason, I couldn't connect to the API.  Please contact my creator and let him know that I failed to get list of open shifts.\",\"stringId\":\"stringId_9c34d3d1b918eaa5\"},{\"id\":\"56f52fb50ba7-b3833c49356c6a20-4251\",\"type\":\"statement\",\"designer\":{\"xLocation\":920,\"yLocation\":380},\"text\":\"I'm so embarrassed, but for whatever reason, I couldn't connect to the API.  Please contact my creator that I failed to get open shifts list.\",\"stringId\":\"stringId_9c34d3d1b918eaa5\"},{\"id\":\"cab59e6f097d-06ef0cbf11176232-ded2\",\"type\":\"statement\",\"designer\":{\"xLocation\":220,\"yLocation\":112},\"text\":\"I'm so embarrassed, but for whatever reason, I couldn't connect to the API.  Please contact my creator and let him know that I failed to get a Token.\",\"stringId\":\"stringId_9c34d3d1b918eaa5\"},{\"id\":\"ad3cbc60f8c2-770728a8fa99d047-b7d0\",\"type\":\"statement\",\"designer\":{\"xLocation\":620,\"yLocation\":360},\"text\":\"I'm so embarrassed, but for whatever reason, I couldn't connect to the API.  Please contact my creator and let him know that I failed to create the shift booking.\",\"stringId\":\"stringId_9c34d3d1b918eaa5\"},{\"id\":\"d3cb3d233cc5-822f28c59d762e6d-afdb\",\"type\":\"statement\",\"designer\":{\"xLocation\":1193,\"yLocation\":269},\"text\":\"I'm so embarrassed, but for whatever reason, I couldn't connect to the API.  Please contact my creator and let him know that I failed to update open shift ID the second time.\",\"stringId\":\"stringId_9c34d3d1b918eaa5\"},{\"id\":\"0b6f11c5a31a-8d09a23d32a62c94-31d1\",\"type\":\"statement\",\"designer\":{\"xLocation\":1200,\"yLocation\":360},\"text\":\"I'm so embarrassed, but for whatever reason, I couldn't connect to the API.  Please contact my creator and let him know that I failed to get list of open shifts the second time.\",\"stringId\":\"stringId_9c34d3d1b918eaa5\"},{\"id\":\"bb8ddb6a4bda-d82c15bb38e27b7f-9f4e\",\"type\":\"statement\",\"designer\":{\"xLocation\":1200,\"yLocation\":452},\"text\":\"I'm so embarrassed, but for whatever reason, I couldn't connect to the API.  Please contact my creator and let him know that I failed to create the shift booking.\",\"stringId\":\"stringId_9c34d3d1b918eaa5\"}],\"interrupting\":false,\"breaking\":false,\"returningMessage\":\"\"}"
}